\documentclass[12pt]{article}
\setlength{\textheight}{9.80in}
\setlength{\textwidth}{6.40in}
\setlength{\oddsidemargin}{0.0mm}
\setlength{\evensidemargin}{1.0mm}
\setlength{\topmargin}{-0.6in}
\setlength{\parindent}{0.2in}
\setlength{\parskip}{1.5ex}
\newtheorem{defn}{Definition}
\renewcommand{\baselinestretch}{1.2}

\usepackage[toc,page]{appendix}

\begin{document}

\bibliographystyle{prsty}

\thispagestyle{empty}

\title{{\it Dors1}---The Earth's Atmosphere}

\author{C. Godsalve \\
email:{\tt seagods@hotmail.com} }

\maketitle

\tableofcontents

\section{Building an Atmosphere --- A First Run-Through}

\subsection{Basics}

The first thing that is required for any atmospheric radiative transfer calculation is
an atmosphere. So much is obvious. The program that sets up
the atmosphere for doing radiative transfer calculations is {\it Dors1}. 

To do any radiation calculations in our ``one dimensional" atmosphere, we 
require an atmosphere consisting of discrete
layers or ``slabs". (The approximation in 1D radiative transfer is that the Earth is an infinite  flat plane,
 and that the properties of the atmosphere and ground have translational symmetry.)
Each layer must have an {\it optical depth}, a {\it single scattering albedo}, 
a {\it phase function}, and a temperature profile. The {\it Dors1} program has the job of creating a
data file containing all this information. If you are unfamiliar with these terms you need
to consult a standard textbook on radiative transfer such as by Chandrasekhar \cite{Chandrasekhar:Mybib},
 Goody and Yung \cite{GoodyYung:Mybib}, or Liou \cite{Liou:Mybib} before you can continue.
As we shall see, we will end up with a set of optical depths (and single scattering albedos) in each layer of the atmosphere,
 as well as a composite phase function.

The  {\it Dors1} program is designed to build a data file representing the Earth's atmosphere under various conditions.
The options the user has for user defined atmospheric properties mean that if the user wishes
to build an atmosphere very different from that found on Earth, this can be done.
This document's emphasis is on 
building up a layered Earth atmosphere and its optical properties from realistic data. 
The data used by {\it Dors1} are based on
the 1976 U. S. Standard Atmosphere \footnote[1]{All the references to the the U. S. Air Force
Geophysical library are available from http://www.dtic.mil/dtic/}  \cite{USStandard:Mybib} and its supplements, especially the AFGL constituent
profiles up to 120km \cite{ConstProfs:Mybib}.

The best thing to do when first using {\it Dors1} (assuming you are in your {The-DORS} directory) is to just type {\it Dors1 -v [ENTER]} at a system terminal.
(If you are used to the command line, then hitting the {\it [ENTER]} key is obvious, and we omit
it in the rest of this article.)
The { \it -v} stands for ``verbose mode". In this mode you will be prompted for all the required
inputs. When {\it Dors1} has finished, it will write a record of what you entered 
 in the file named  {\it Dors1in.dat} (unless otherwise specified).  It isn't a bad idea to make a copy of this file to something 
like {\it example.Dors1in.dat}.

If at some later stage you wish to make a small modification to the atmosphere defined by your original input, you can 
just edit the input file ({\it Dors1in.dat}) and run {\it Dors1} again --- but this time without the ``-v". If not in verbose
mode {\it Dors1} will read its input from {\it Dors1in.dat}. 
Once you have had some experience of the verbose input, making edits 
to {\it Dors1in.dat} should be easy enough.
So, after editing {\it Dors1in.dat} just type {\it Dors1}. This will read {\it Dors1in.dat} and build a modified
atmosphere. If you have a different name for the input file, say {\it Dors1inX.dat}, just type
``{\it Dors1 Dors1inX.dat}" instead. 


The following descriptions of the various inputs and options make rather dull reading, but this part of
the document will be handy to have alongside
you when you run the program. Also, see some on-line videos which explain 
 {\it Dors1, Dors2} and {\it Dors3} \footnote[2]{Youtube video not yet done}.

\subsection{Wavelengths}

So, let's start a ``run through" of {\it Dors1} -v.
On running {\it Dors1 -v}, the first information that you will be asked to enter concerns wavelengths.
For most practical purposes some wavelength range is needed rather than just a single wavelength. It
is quite often the case that we need to predict an instrument response, and this requires some
model of an instrument. Note that all wavelengths are the vacuum wavelengths and so are independent of the
refractive index of the air.

The very first thing we are prompted for is to whether we are using an {\it instrument response function} or not.
What does this mean?  If we are modelling atmospheric radiation measurement by some specific real-world 
instrument,  it will have  a wavelength dependent response. We must specify that response function in a data file
 (the default name for this file is $myresp.dat$). If we are {\it not} modelling an instrument
 we can just enter two wavelengths covering some range. If we enter 1 as a response to this last prompt {\it Dors1} will
need a response function file. For now, just enter zero. Since no response file is to be read, 
we are prompted for a start and end wavelength. The response function is then assumed to be constant between those two 
wavelengths and zero outside this range (a ``top-hat" function). If we want to look at the wavelength
range 0.6 to 0.70 micrometres, we enter the smaller wavelength ($\lambda_1)$ of 0.60 first, and the larger
wavelength ($\lambda_2)$ of 0.70 second. 

If, for some small range of wavelengths, there are no sharp absorption  features due
 to molecular absorption lines, we can in effect use just a single wavelength (by setting $\lambda_2=\lambda_1$).
By small, we mean that the wavelength range is
small enough so that the aerosol phase function, single scattering albedo, and optical depth,
 and the Rayleigh scattering optical depths do
 not change in any significant way over the wavelength region. 

Unfortunately, whenever there are many sharp features such as molecular absorption lines over a given wavelength
range, we cannot use a single wavelength approximation.
This means much heavier computation.
The {\it Dors} uses a correlated-$\kappa$ approach in this case. 
Detailed explanations of the correlated-$\kappa$ approximation are given in \cite{GoodyWest:Mybib}, 
\cite{LacisOinas:Mybib}, \cite{FuLiou:Mybib}, and \cite{RoseKratz:Mybib}. 
Band models are an alternative \cite{GoodyYung:Mybib} \cite{Liou:Mybib},
and when multiple scattering calculations are required, these can be converted
to correlated-$\kappa$ distribution functions \cite{Goody:Mybib}, \cite{Domoto:Mybib}, and
 \cite{GodsalveBand:Mybib}. The {\it Dors} doesn't use band models, and {\it Dors1} tailors the correlated-$\kappa$ method 
 to the  instrument response function (which is set to a top-hat if we only specify a wavelength range and don't use a response function file). 

In the non-verbose mode, if you are using an instrument response file not called {\it myresp.dat}, just 
type ``{\it Dors1 Dors1inX.dat Xresp.dat}" where {\it Xresp.dat} is whatever
your response function file name is. (Note in this case you need to specify a {\it Dors1in} file {\it and} a response function
file in that order.) When running {\it Dors1} in verbose
mode, the response function file name {\it must} be {\it myresp.dat}. 

 The {\it myresp.dat}  file  shall
consist of one line specifying the number of points $n$,
 followed by $n$ lines consisting
of wavelength-response function pairs. The wavelengths $\lambda_1$ and $\lambda_2$ will be
 set to the first and last wavelengths in this file, even if the
 response function is zero at these wavelengths.
Cubic splines shall be used to interpolate the response function, so make sure that the number $n$ isn't
too small for the given response function.

The following {\it myresp.dat} file is valid, and will be identical to using a wavelength 
range of $0.6\mu m$ to $0.7 \mu m$ without a response function file. 

\begin{verbatim}
5
0.6   10
0.625 10
0.65  10
0.675 10
0.7   10
\end{verbatim}

The rest of the wavelength information that needs to be input concerns molecular spectroscopy. Reading
in the required files and doing all the calculations 
is generally a fairly intensive task, and these calculations can be avoided when possible. If, for instance
we have built an atmosphere, and now need a new one  --- are the spectrospcopic calculations necessary?
If we are only changing aerosol loading or some other thing that will not affect
the molecular absorption, then the answer is no. Also, we may know in advance that molecular absorption is negligible
 for our wavelength range or purposes --- and so needn't bother with the extra computing time reading in all the files and computing the spectra.


The next input we are prompted for is to whether to calculate molecular absorption spectra or not.
If we have made a run of {\it Dors1} already, with this value set to 1, it will have output the
correlated-$\kappa$ data required by {\it Dors3} in a separate file. 
We may not wish to re-do these calculations and over-write that file for reasons discussed later.
For now enter 1 as a response. If we are doing these calculations, we may want to examine the fine
detailed spectra rather than just the few $\kappa$ values needed for the correlated-$\kappa$ method.
We are prompted as to whether we want this output or not. These are large files, and if they aren't wanted, enter zero.

If there are absorption lines in your wavelength intervals you might want to take a look at them and see
if you have the right resolution in the spectrum given the cutoffs and resolutions you will choose in a moment.
In this case you will need to choose to calculate the absorption spectra and choose to output the files.
The shall be written to the {\it MolSpect} directory. Note that if you want to keep these files, you must create
a subdirectory within {\it MolSpect} and move them there. If you have previously calculated spectra in the 
{MolSpect} directory, {\it Dors1} will refuse to overwrite them and exit. You have to delete them
 or move them to a subdirectory (or elsewhere) before you calculate a new spectrum.

You may want to see what
the spectra look like. You quite probably have software to plot the spectra, if not you might choose to
 get {\it PlotIt} which is one of my own graphics programs \footnote{git@github.com:seagods/PlotFiles.git}.
If you decide to use PlotIt, the files containing the spectra have to be output in a particular way
with line colours, styles, and so on, specified in the data files.
For this reason you are prompted as to whether or not you are using {\it PlotIt}. If not, the output file
format is one line containing the number of layers, one line containing the number of points, then that line is
followed by that number of $(x,y)$ pairs. This is followed by one line containing the number of points in the spectrum
of the next layer and so on. There is one file for each isotopologue of each gas. You are next prompted as to whether
or not you want to output to be the log (base 10) of the cross section as a function of wavenumber.

Now, we have included an unusual fetaure in {\it The-DORS} in that it has the capability  in that it
 can calculate the refractive index
as a function of wavenuber via the Kramers-Kronig relations \cite{KronKram1:mybib}. This is an expensive
computation. You are therefore prompted as to whether or not you want to do this, and whether or
not you want to output the fine refractive index spectrum files in the same way as the cross-section files.


We mentioned already that we are using a correlated-$\kappa$ approach, and this needs a quadrature rule
for integrating over the cumalative-$\kappa$ distribution function. We do this using Gauss quadrature, and the
next prompt is for the order of quadrature rule. Enter 10, say.

Now we are at the last part of the wavelength input. We change over to the more usual spectroscopic units
of {\it per cm} or $cm^{-1}$. So $10^3 cm^{-1}$ corresponds to $10\mu m$ radiation, $10^4 cm^{-1}$ corresponds
to 1$\mu m$ radiation, and so on. So, if we denote the wave number as $\tilde{\nu} (cm^{-1})$ and the wavelength as $\lambda (\mu m)$
then $\nu=10^4/\lambda$. We make the trivial observation that $d \tilde{\nu}/\tilde{\nu}=-d \lambda / \lambda$.

The molecular absorption calculations need a ``cut-off" which tells
the program how far away from on an absorption line centre we need to calculate the absorption profile
of the absorption line. It also needs a spectroscopic resolution (or step size) for the wavelength interval.
In fact we need to choose between the largest of two possible cut-off values. Each line has a Doppler and a Lorentz
 half width, which we denote as $\alpha_D$ and $\alpha_L$ ($cm^{-1})$. 
If we choose a cut-off integer $i_{CD}$ so that the cut-off for a pure Doppler line is $ i_{CD} \alpha_D$
then the Doppler broadened line falls off as $\exp(-i_{CD}^2)$. So, for $i_{CD}=5$, the value of the line shape at the
cut-off is roughly 0.7\% of the value at the line centre. 
If we choose a cut-off integer $i_{CL}$ so that the cut-off for a pure Lorenz line is $ i_{CL} \alpha_L$
then the Lorentz line falls off as $1/(1+i_{CL}^2$). So, for $i_{CL}=12$, the value of the line shape at the
cut-off is also roughly 0.7\% of the value at the line centre. If it is required that more of the line is within
the cut-off, then we need to increase $i_{CL}$ more than $i_{CD}$ since the Doppler profile falls off much more rapidly
than the Lorentz profile. The actual value of the cut-off is to taken as whichever value of $i_{CD} \alpha_D$
 and $i_{CL} \alpha_{DL}$ is largest. We need another integer for the spectral resolution. When calculating the spectra
we shall use $\Delta \nu$ as the halfwidth value divided by $istep$. These three integers
 are prompted for when $Dors1$ is run in verbose mode. The prompts are,
 "Enter (integer) number of linewidths for cut-off for a Lorentz profile"; "Enter (integer) number of linewidths for cut-off for a Doppler profile"; "Enter istep (integer that sets the resolution for each line --- make it 10 or more)".



\subsection{Layers and Aerosols}

{\it Dors1} splits up the Earth's atmosphere into four distinct regions.
These four different regions are needed because of
 different  atmospheric aerosol types. In the lower
kilometre of atmosphere or so we may have different types of boundary layer
aerosols in addition to the background tropospheric aerosols. From a couple of kilometres
up to the stratosphere, we have  just the background tropospheric aerosols, and in the stratosphere we may have
volcanic aerosols. The aerosols in the atmosphere above the stratosphere are different again.
These regions follow the example of an old atmospheric radiation code called {\it LOWTRAN 7}
\cite{LOWTRAN:Mybib}, and  its successor {\it MODTRAN 5} \cite{MODTRAN:Mybib}.
If it were not for differing aerosol types, with different scattering and spectral properties,
we would not need these four distinct regions. The topic of atmospheric aerosols is not a trivial
one, so we leave a more thorough discussion of them for later, for the present we just
want to know what to input into the radiative transfer program.

Could  we treat an atmosphere as a single layer were it not for aerosols? The answer to 
this question is that we could not.
The different molecular species in the Earth's atmosphere have different absorption spectra, and these spectra
depend on the temperature and the pressure which vary with height, as does the mixing ratio
of different molecular species.
In order to capture this, we must subdivide the atmosphere into ``slabs" where the temperature and
the pressure do not vary too much. The need for the aerosol regions is less in the thermal infrared
than the other spectral regions, but in the {\it Dors}  the four aerosol
layers are used throughout the full spectral range: each can be split into smaller sub-layers. 

So, let's  continue with  our ``run through" of {\it Dors1} -v.
 The next question we are prompted with  concerns how we are to enter the amount of tropospheric
and boundary aerosol. We are asked whether we want to enter optical depths or visibilities.

If we have estimates of the aerosol optical depths of the upper
troposphere and the boundary layer (at a wavelength of $0.55\mu m$) then we can choose the option to enter these optical depths.
Otherwise we may enter a ``visibility" (or more accurately a {\it meteorological range}) in kilometres.
The more aerosol there is, the lower the visibility. On a very clear day we can see tens of kilometres.
 On a very hazy day, things that are only a couple of kilometres away are obscured by haze. In
this way, the we have a fairly intuitive grasp of what kind of values to enter. If
 visibility
is chosen, the actual aerosol optical depth  is calculated via Koschmieder's empirical formula \cite{Koschmeider:Mybib} 
 as used in \cite{Longtin_etal:Mybib} for example.
In fact, this formula gives the aerosol optical depth at a wavelength of 0.55$\mu m$. The aerosol optical
depth at other wavelengths will be worked out from the combination of aerosol models used.
Again, we discuss this in detail later. Also, for each layer, we need the Rayleigh optical depth due to molecular scattering,
and a different set of optical depths for water vapour and trace gases. In order to describe non-grey molecular absorption,  we 
need a {\it set} of optical depths/extinction coefficients {\it for each molecular absorber}. The number of
coefficients in each set is determined by the order of Gauss quadrature already entered for integration over
 cumulative-$\kappa$ distributions.
 
Next, you are prompted to enter how many sub-layers layers each of
the four main aerosol regions are to be split into. If you just want just one slab for
each aerosol region, enter 1 for each region. You can choose any number of slabs for
each aerosol region you like. Note that this also affects the molecular spectra used
because of the temperature and pressure variations of the absorption line widths within the four main
aerosol regions. You need to
gain experience in how fine a height resolution of the atmosphere you need and how this resolution
 affects the radiation calculations. At this point we must mention
that the layers are not split up into slabs of equal physical thickness. They are split up
so that the pressure change across each sublayer is the same.

The next input you are prompted for is to choose between Spring/Summer or Autumn/Winter. 
This affects what atmosphere numbers
(from 1 to 7) you are prompted to choose from next. Later, it affects which tropospheric and
upper atmospheric aerosols you are prompted for. An explanation of which numbers you can choose
from and what they mean is written to the standard output.


There are  6 pre-defined atmospheres,  and the possibility of having a ``user defined" atmosphere.
The six pre-defined atmospheres numbered 1 to 6 respectively, are tropical, mid latitude Spring/Summer and Autumn/Winter, and 
sub-Arctic Spring/Summer or Autumn/Winter, and finally
the U. S. 1976 standard atmosphere. 
Atmosphere numbers 1, 6, and 7 are tropical, standard, and user defined, and these are independent of season.

Now, if we do not use season independent atmospheres, the tropospheric 
and stratospheric aerosol models are dependent on the season.
 If you have chosen Spring/Summer or Autumn/Winter, 1, 6, and 7 are still available. 
 If you have chosen
Spring/Summer, atmospheres 2 and 4 are available, otherwise atmospheres 3 and 5 are available.
These are the four allowed variations on mid-latitude, sub-Arctic, and Spring/Summer and Autumn/Winter.

Now, some users might want to look at the interaction 
 between Rayleigh scattering and scattering from aerosols. To help with this we have the option
of switching either of these off. Normally, neither will be switched off, and you just select
zero when prompted as to  whether or not switch off Rayleigh or aerosol scattering. In the thermal
infrared you might want to switch off both.

Next, we are asked to enter numbers that tells {\it Dors1} what aerosol extinction profiles
and phase functions to use for the upper atmosphere, the stratosphere, and the boundary layer.
The upper atmosphere options 13-16 range from a normal upper atmosphere to an ``extreme volcanic"
option. For the stratosphere, the options vary from stratospheric background to extreme volcanic.
These depend on the Spring/Summer or Autumn/Winter option chosen earlier.

Now, the next section is about water vapour. This is the most variable of all the
constituents in the atmosphere.  Each of the first six atmospheres has a different number
density of water molecules as a function of height. You might, however, want to choose your
own without going to the length of defining your own atmospheres.  A common way anyone
might want to do this is by defining a humidity profile. {\it Dors1} enables you to do 
this and you are asked whether you want to use the defaults as defined in the six pre-defined
atmospheres, or override the pre-defined profile. For now, just enter one to select the
pre-defined profile.

Pressure and temperature at the ground are also highly variable. The user can ``tweak" the
pre-defined profiles to take this into account. You are prompted as to whether you have ground pressure
and/or temperature data. You will be prompted further if you say you do. If you enter
your own ground pressure that is say, 1.05 times the pressure at the ground
in the chosen profile, this will scale the entire column pressure by 1.05. If you enter a ground
temperature, then 
temperature at 1km ($T[1]$) is set to $T[1]\times T_{ground}/T[0]$, the temperature
 at the ground ($T[0]$) is changed to $T_{ground}$, and the all other temperatures are unchanged. For now, just
enter zero so that the pre-defined profiles are unchanged.

Other things that may vary are the height of the ground, the thickness of the boundary layer,
 the height of the troposphere, and so on. You are next prompted as to whether you want to
use the default heights or enter your own. For now select the default.

The last thing that we are prompted for is the order of the 
 Gauss-Legendre rule that calculates integrations in height in each sub-layer of each
aerosol region. 
You will need to experiment with how the results vary with the order of the quadrature rule. For now, just choose 4.

\section{An example Input File}

So, we have finished our first run-through of {\it Dors1 -v} and this has created a record of our input in
 {\it Dors1in.dat}. Look at the following example.
\begin{verbatim}
0.500000 0.600000 0 
1 1 1 1 1 1
10
5  12 10
1 40.000000 20.000000
1 2 3 4
2
0 0
13 6 3 1 0
1 0 0 -1000000.000000 -1.000000
0 -1000000.000000
1 0.000000 2.000000 10.000000 30.000000 120.000000
4
\end{verbatim}
In the first line, we have $\lambda_1$, $\lambda_2$, and the bool which tells us whether
we are using a response function file. If we are using a response function, the two wavelengths
will be reset by the first and last wavelengths in the response function file, but two dummies are still required as input in
{\it Dors1in.dat}. There are six values of siz bools on the next line. This tells us that we are to calculate new molecular absorption files and shall not use the results of any previous calculation, the next 1 tells us that we are writing out
 the absorption coefficient spectrum for each gas in each layer. The next 1 tell us that we are using
the $PlotIt$ program, the next 1 is that it is a  log plot, the next 1 says we are calculating the refractive index, 
 and the last 1 tells us we are writing out
refractive index spectra. More usually that line would be "1 0 0 0 0 0". There must be six values on this line.
 
The 10 on the next line tells us that we are using
10 point Gauss quadrature for the integration over the cumulative-$\kappa$ distribution for calculating non-grey 
radiative transfer. The next line ends the wavelength related inputs, and are related to the sum of the
Lorentz and Doppler half widths at half maximum or ten times what we shall call the ``total half width"
The line tells is we have a Doppler cut-off of 5 times the Doppler half width, a pressure broadening 
cut-off of 12 times and Lorentz half width. The program select the largest of these two cut-offs,
 and the step size shall be the cut-off divided by 10.

 The next line has three numbers. The 1 tells us we have chosen to
 use visibilities,  and have chosen a tropospheric visibility of 40km and a boundary layer visibility
of 20km. The four numbers on the next line says that the 
upper atmosphere is just 1 slab. The stratosphere is split into two slabs, the upper
troposphere is split into three slabs and the boundary layer is split into four. Recall 
that the splitting ensures that the pressure change across each sub-layer of an
aerosol layer is constant, the physical thicknesses are not constant.

The single number on the next line is 2 because a mid latitude spring/summer was chosen.
The first zero on the next line indicates Rayleigh scattering is not turned off, and
the second indicates that aerosol scattering is not turned off.

On the next line we see the numbers 13, 6, 3, 1, 0.
The value of 13 shows we have a normal upper atmosphere. Other values might be 14 for ``transition
from volcanic to normal", 15 for transition from volcanic to extreme volcanic", and 16 for
 extreme volcanic. Then the value of 6 means we have chosen ``Background volcanic Spring/Summer".
We could have chosen 8, 10, or 12 for ``Moderate volcanic", ``High Volcanic", or ``Extreme volcanic".
If we had chosen Autumn/Winter, the corresponding option numbers would have been 5, 7, 9, and 11.

When run in verbose mode, there is no input number for the tropospheric aerosol type. 
The troposphere type number is set
internally and will be 
be 3 for Spring/Summer and 1 for Autumn/Winter. In non verbose mode it must be set by the input file.
Make sure that it is set with to 1 or 3 according to Autumn/Winter or Spring/Summer. 
So the number 3 indicates we have chosen Spring/Summer. After this we have the boundary layer type.
The value of 1 indicates ``rural".
What is that zero at the end? If we had chosen the ``Maritime/Ocean" option we would have
been prompted for which of the two this was. A number has to be there regardless of what option
we choose for the boundary layer. If we choose 3 for the boundary layer option, this last number is
either 1 for open Ocean, or 0 for Maritime.

Note that there is no mention of what choice we have made for the season. When run in non-verbose mode
 {\it Dors1} needs no such information. It is only in verbose mode that it asks for the season, and that
 information only determines later prompts.

The next line indicates that we have chosen 1 when prompted as to whether or not
the default water vapour profiles, and so shall use the default water vapour profiles. We chose 0 
when asked if we had either ground pressure and/or temperature data 
so the bools groundP and groundT are initialised as false.
 This indicates that  we have no information  on either temperature or pressure. 
On the same line as these options (1, 0, 0) 
are two (silly) numbers for
temperature and pressure. These have to be there regardless, even though we have no information
on temperature and pressure. Because we have entered 0 for the option, they won't be used.  
(Make them negative to make it obvious they are not to be used.)

The next line starts with a 1, indicating that we are using the default heights for
the ground, the boundary layer, tropopause, stratopause, and Top Of Atmosphere (TOA).
This is followed by four numbers. If you have chosen the defaults, these numbers will be
the default values of 0, 2, 10, 30\footnote{The {\it actual} stratopause is close to 50km - these are
$LOWTRAN$ aerosol regions: the $LOWTRAN$ stratosphere is not the physical stratosphere...}, and 120.

The last line is the order of the Gauss-Legendre quadrature rule for integrations
over height which is 4. So we have finished our ``run through" of {\it Dors1}. Now we know what to input, and what it means, we
can begin to see what {\it Dors1in.dat} actually does and how it does it.




\section{The Atmospheric Data}

We have seen we have six default atmospheres to choose from. The first is tropical, the next four
are mid latitude (45N) and sub-Arctic (60N)  Summer and Winter, then the last is the U. S. 1976 standard. 
We also have the possibility of a user defined atmosphere.
You will see that the {\it Dors} directory contains a sub-directory  called {\it Atmospheres}.
This has a subdirectory called {\it StartMols}. Copy everything in {\it StartMols} to {\it Atmospheres}.
(We may make changes made to the data files in the {\it Atmospheres} directory  --- and {\it StartMols}
can be used to reset the changes.)


This contains a file called {\it Alts.dat} containing the number of altitudes defining
the atmospheric profiles and then one line for each altitude. Then we have the files
{\it Temps1.dat} to {\it Temps6.dat} which contain the temperature profiles for the six default atmospheres
and an extra file {\it TempsU.dat} for a user defined temperature profile. Similarly, for pressure,
 we have the files {\it Press1.dat} to {\it Press6.dat}, and {\it PressU.dat}. Naturally these
must correspond to the heights contained in {\it Alts.dat}.

 In these atmospheres, the only constituent profiles that depend on latitude or
whether it's Summer or Winter are water vapour,  carbon monoxide, ozone, nitrous oxide, and methane. 
All the molecular species in the {\it Dors} are numbered as in the 1976 standard. These are listed
in table 1 below.

The height
 dependence of all the other atmospheric constituents are just those of the 1976 standard.
 So, to take methane as an example, we have the atmospheric concentration in $ppmv$ contained
in {\it Mols1\_CH4.dat} to {\it Mols6\_CH4.dat} and {\it MolsU\_CH4.dat}. These correspond to
methane for the 6 standard atmospheres and a user defined atmosphere.
The concentrations of gases such as methane are highly variable, so --- apart from water vapour --- the user defined option
is there mostly for CO, O3, N2O, and CH4. 

Water vapour is the most variable of all. 
If you don't want to change anything apart from water vapour in atmosphere models 1-6 or your
user defined model, 
you can copy the humidity profiles {\it Hum1\_1.dat} and {\it Hum2\_1.dat} for atmosphere 1
 to {\it Hum1\_U.dat} and {\it Hum2\_U.dat} and alter these for the user defined profile.
 Why {\it Hum1} and {\it Hum2}? If you have chosen
the option to override the data used in {\it MolsX\_H2O}, then {\it Dors1} will ``look at" the temperature
and calculate the number density of water vapour molecules using the humidity in {\it Hums1}
 if the temperature is above freezing, and {\it Hum2} if it is below freezing. (Equilibrium vapour pressures
of water vapour over liquid water and ice are different --- hence ``humidity 1" and ``humidity 2".)

So, we can select atmospheres 1-6 or a user profile which varies H2O, CO, O3, N2O, and CH4. 
Then we have the possibility of overriding the water vapour
profile using humidity data.  Two gas profiles O2 and CO2 are independent of latitude and season.
This accounts for gases 1-7. What about the rest? Are these highly variable?
 To quote \cite{ConstProfs:Mybib} ``{\it Molecules 8-28 are provided
as single representative profiles. Their natural variability can be very different from the selected 
profiles.}" If, for instance you want to experiment with the profiles, just overwrite the ones provided
with your own! Recall that {\it Atmospheres} directory contains a sub-directory called {\it StartMols} which  contains
a copy of all the profiles that {\it Dors1} came with originally. Once you have finished, you can just reset 
 the profiles you have experimented with according to the originals. 

The temperature and pressure profiles
for the six AFGL atmospheres, along with the atmospheric profiles of the gas concentrations for 28 gases
including the atmosphere dependent ones can be seen in Appendix A. Note we have missed out profiles
for Nitrogen, Oxygen, and CO2 for obvious reasons. (Just replace {\it Mols\_CO2.dat} if you are interested in
varying CO2 concentration: the default concentration is out of date.)


\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
Number & Molecule & Name & Number & Molecule & Name \\ \hline
1 & H2O & Water Vapour & 15 &HCl & Hydrochloric acid  \\ \hline
2 & CO2 & Carbon dioxide & 16 & HBr & Hydrogen Bromide\\ \hline
3 & O3 & Ozone & 17 & HI & Hydrogen iodide \\ \hline
4 & N2O & Nitrous oxide & 18 & ClO & Chlorine monoxide \\ \hline
5 & CO & Carbon monoxide & 19 & OCS & Carbonyl sulphide\\ \hline
6 & CH4 & Methane   & 20 & H2CO & Formaldehyde \\ \hline
7 & O2 & Oxygen & 21 & HOCl & Hypochlorous acid\\ \hline
8 & NO & Nitric Oxide & 22 & N2 & Nitrogen\\ \hline
9 & SO2& Sulphur Dioxide &23 & HCN &  Hydrogen Cyanide\\ \hline
10 & NO2 & Nitrogen Dioxide & 24 &  CH3Cl & Methyl chloride\\ \hline
11 & NH3 & Ammonia & 25 & H2O2 & Hydrogen peroxide\\ \hline
12 & HNO3 & Nitric acid & 26 & C2H2 & Acetylene\\ \hline
13 & OH & Hydroxyl radical & 27 &  C2H6 & Ethane \\ \hline
14 & HF & Hydrogen Fluoride & 28 & PH3 & Phosphine\\ \hline
\end{tabular}
\caption{The 28 AFGL Gaseous Constituents}
\end{center}
\end{table}

We are using the HITRAN \cite{RothmanETAL:Mybib} database to calculate molecular absorption.
This includes 14 extra gases numbered 29 to 42.
I have no idea as to what the concentrations of these extra constituents should be as a function of height
, however I have
included ``dummy" profiles for the extra gases included in HITRAN. Most likely, you won't
bother with  them. In fact I have included the possibility that you have data on gases not
in the HITRAN database. these 8 extra ``dummy" gases are numbered 43-50, and you need to overwrite the
``dummy data" contained in these files with your own. Not only that, you need to add your own ``par" files
to the {\it HITRAN} subdirectory of your {\it The-DORS} directory. Obviously, these must be written in the standard  {\it HITRAN} format.
Again, I should think it quite rare
that this feature would be useful, but it is included nevertheless.
\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
Number & Molecule & Name & Number & Molecule & Name \\ \hline
29 & COF2& Carbonyl Fluoride & 36 & NO+& Ionised Nitric oxide\\ \hline
30 & SF6 & Sulphur Hexaflouride & 37 & HOBr & Hypobromous acid \\ \hline
31 & H2S & Hydrogen sulphide & 38 & C2H4& Ethylene \\ \hline
32 & HCOOH & Formic acid&  39 & CH3OH & Methanol\\ \hline
33 & HO2 & Hydroperoxyl radical& 40 &CH3Br & Methyl Bromide\\ \hline
34 & O  & Atomic Oxygen&   41 & CH3CN & Acetenitrile\\ \hline 
35 &ClONO2& Chlorine Nitrate & 42 & CF4 & Carbon Tetraflouride \\ \hline
\end{tabular}
\caption{Extra Constituents in HITRAN}
\end{center}
\end{table}
So, gases 1-11 are the LOWTRAN gases. Gases 1-28 are the AFGL gases, and gases 
1-42 are the HITRAN gases. We have slots for extra gases numbered 43 to 50.

Many of the gases are negligible as far as the absorption of radiation is concerned.
In these cases the HITRAN data are useful for atmospheric chemistry.

 You can select which ones
to ignore altogether.
You should be able to see a small file called {\it GasMask.dat}. This consists of five pairs of
lines. The first line of the first pair consists of the numbers 1-10. These stand for gases
numbered 1-10. The next line of the first pair consists of ten numbers which must be 1 or 0.
Any of the gases 1-10 with a zero below it will be ignored altogether. Obviously, the next four pairs
are provide the mask for gases 11 to 50.
 Only those gases that
have a corresponding 1 will be used when running the {\it Dors}.
 For many purposes, only some of the first seven gases need be used for atmospheric
radiation purposes, the choice depending on the wavelength interval.

\section{Integrations}

What we need to calculate molecular absorption using the HITRAN data
is each individual absorber's mass per square cm
in each sublayer, the mean temperature, and the mean pressure. The file {\it Alts.dat}
has one number $i\_altitudes$ followed by that number of lines each containing one height.
The pressure and temperature files have the same format. The structure of an example
atmosphere is shown schematically in Fig.1 below.
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=Fig1.eps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{A schematic diagram of the vertical structure of the atmosphere
as split up by {\it Dors1}. These values of {\it nsplit}  yield 10 radiative
layers  numbered top down.}
\end{figure}

The altitudes are stored in the array {\it altitude}, and the corresponding
pressures and temperatures are stored in the arrays $P$ and $T$.
The pressure is interpolated as a function of height to get the pressures
at the the height of the ground ($HG$), the boundary layer ($HB$), the 
tropopause $HT$, the stratopause $(HS)$ and the TOA ($HU$). Then the values
of $nsplit1$ (number of slabs in the upper atmosphere) to $nsplit4$ (number of
slabs in the boundary layer) are used to obtain the pressures at the ``floors"
of each slab (from the ground up) so that the pressure intervals across each
 slab of a particular aerosol region are equal. These pressures are stored in the
array {\it floorpress}. The height is then interpolated as a function of pressure
so that the physical heights of each slab's ``floor" can be found. These
are stored in the array {\it Heightfloors}. So if the atmosphere is split as in
Fig.1, there are ten ``floors". The physical thickness of each of these slabs
is stored in an array called {\it SlabThick}. The distances are all now in metres
rather than kilometres, and everything is still ``ground-up".

The Gauss-Legendre quadrature weights and abscissae on the interval [0,1] are found, and using
these, {\it Heightfloors} and {\it SlabThick}, we find the height of each quadrature point 
in each sublayer. These are stored in an array called {\it heights} of dimension {\it iheight}.
The pressures and temperatures at these heights are interpolated onto the corresponding
arrays {\it Press} and {\it Temp}. These heights, pressures and temperatures are still
from the ``ground up".

Now for a bit of very  basic `A-level' physics \footnote[1]{University entry level 
in the UK}.
 The pressures in the arrays {\it P} and {\it Press}  are stored in millibars,
so to use any formula requiring Pascals, we multiply by 100. To get the number of
particles  $N$ per cubic metre, we multiply the number of moles per cubic metre by Avagadro's number $A_v$.
That is we use
\begin{equation}
N= \frac{ 100 P(mbar) A_v}{RT},
\end{equation}
 where $A_v$ is Avogadro's number.
For the purposes of this article, I use the old fashioned term ``molecular weight" to mean
the same thing as the more correct {\it molar mass} in grammes per mole. I have named the
molecular weight of air as $MWA$. To get from the number density to the density $\rho$
 in $Kg \> m^{-3}$ we use just
\begin{equation}
\rho=\frac{N \times MWA}{1000 A_v}.
\end{equation}
The 1000 in the denominator is to convert from grammes to Kilogrammes. So for each height
in the array {\it heights} we have a corresponding value $N$ stored in an array named $ENN$.

Now, recall we had a file called {\it GasMask.dat}. If $ngas$ of these 50 molecules
are not masked out, each of the corresponding molecular mixing ratio files are opened and the
data is read in. (These files are all stored in the $Atmospheres$ directory and all these
file names begin with ``Mols".  Every file (including the temperature and pressure data) has
an integer $idata$ describing the number of altitudes ({\it i\_altitudes}). If it does not match the value
for {\it i\_altitudes}, then {\it Dors1} will exit with a non zero return value. So, if {\it
Dors1} exits successfully, then $idata$ and {\it i\_altitudes} are one and the same.
So $ngas$ of the molecular data files are opened, and the height profile in parts per
million is read in. Some of these will depend on the atmosphere number chosen in the
input. 

Now, the default way to calculate water vapour masses uses the atmosphere data
in {\it Mols1\_H2O} to {\it Mols6\_H2O} and {MolsU\_H2O.dat}. Water vapour
is an exception for yet another reason. Not only do we want to know the mass per square
cm for spectroscopic reasons, we want to know the humidity as a function of height
because some aerosol models are humidity dependent.
 So, we must calculate the humidity from the temperature and pressure
profiles at the heights in {\it altitudes}. In fact we calculate two humidity
profiles. One is the humidity for water vapour in contact with a plane parallel surface
of liquid water and the other over ice \footnote{The author is aware of the shortcomings
of this approximation, but this will not be dealt with in this release of {\it The-DORS}}. These profiles are contained in the arrays {\it Hum1}
and {\it Hum2}. Two more arrays, {\it Humids1} and {Humids2} are found by interpolation
onto the {\it heights} grid. These are calculated using a method due to
Buck \cite{ArdenBuck:Mybib}·

Another file is opened called {\it Atmospheres/AllMolW.dat}. This consists of seven
lines of numbers followed by one last line containing just one number. The first 42
numbers are the molecular weights of all 42 HITRAN gases. The other numbers
contain dummy values which you must enter if you want some gases not in the HITRAN
database. If you have $ngas$ gases for which the mask value is one, the array
{\it MWGAS[ngas]} will contain the molecular weights of the gases not ``masked out".
Along with this array, we have the  2D array $GasPPM[idata][ngas]$. All this information
allows us to calculate the mean temperature and pressure in the each slab of atmosphere
and the mass of each molecular species per unit area within each slab.

We have other data in that the molecular species have different isotopes for their constituents.
 The largest number of these {\it isotopologues} is for CO2 which has ten variations.
The number of isotopologues for each species is stored in an array called {\it nice} which
is read in from the file {\it Atmospheres/AllIsos.dat}.

In your {HITRAN} directory you have a copy of {\it molparam.txt}. For each isotopologue
we read in the arrays {\it nicecode[i][j]}, the isotopologue code; {\it AllMolW[i][j]}, the molecular
weight; {\it niceabund[i][j]}, the isotopologue abundance; {\it geejay[i][j]}, the state independent 
statistical weight; and {\it QT[i][j]}, the partition sum at 296K. I have set an integer {\it nicemax}
to two, so that only the two most common isotopologues are considered. You may want to edit
{\it Dors1.cpp} and set it to one, or increase it.


\section{Including the Spectra}

Having read in the atmospheres, the Dors starts doing vertical integrations and calculating
the Rayleigh optical depths and the masses of each gas in the all the sub-slabs. This
means that we need the HITRAN data. We need to go back to the run-through of {\it Dors1}.
The last thing we were prompted for was the order of the Gauss quadrature rule for the integration
in each sub-layer.

When running {\it Dors1} you may want to change only the aerosol component, or the ground reflectance.
In this case we don't wish to recalculate the spectra and the correlated-$\kappa$ data. Recall we
 were prompted as to whether or not we wanted to calculate molecular absorption.
When {\it Dors1} writes the input for {\it Dors3}, it prints either the molecular absorption
 data for a single wavelength,
 or $\kappa$ values for the correlated-$\kappa$ approximation in a file separate from the other data necessary for
{\it Dors3}. If we choose not to calculate the molecular absorption when running {\it Dors1}, then {\it Dors3} will read the previously
existing file.
Then {\it Dors1} doesn't need to re-read the HITRAN files and re-calculate k-distributions and so on.
 You {\it must}
say you will calculate molecular absorption on a first run for a given atmosphere  --- otherwise you
will ``pick up" a stale correlated-$\kappa$file.

So, on  a first run, always set this input to be 1 (unless your {\it GasMask} entries are all zero anyway).
 You must also choose 1 if you change the pressure or
temperature profiles, change {\it GasMask.dat}, or change the way that the aerosol regions are
split into sub-layers. If the aerosols change and/or the ground reflectance changes from a previous atmosphere
 choose 0. Of course, if you know that molecular absorption is negligible
 or zero for your wavelength interval then set all the {\it GasMask} entries to zero in the first place.

\section{Aerosol Models}

Though users may define their own aerosol models, we have performed the Mie calculations on several standard 
aerosol models. These models have been used in LOWTRAN,  MODTRAN, 6S, and elsewhere, and may be regarded as
 the default aerosol models for the DORS also. We shall go into some detail as to the origin of the 
models and the extensive
 Mie calculations based on these models done by the author here.

First, by aerosol, we mean any particulate matter suspended in the air. As such, this particulate matter can
both scatter and absorb radiation. In general, many of these particles will not be spherical. 
However but we  shall use scattering from spheres as 
a numerical model for aerosol scattering. 

These spheres are to be 
considered as being far apart in terms of wavelength, and so the scattering is considered to be independent. By
this we mean that the local electric fields generated by the incoming radiation in one sphere do not affect
any other sphere: only the radiating far field matters.

To model scattering from a single sphere requires the complex refractive index of the material, the radius of
the sphere, and the wavelength of the light. However, there shall be a whole range of particle sizes. Therefore
we need a probability distribution function (or pdf) for the spheres that make up our model scatterers.
The problem of scattering from such a {\it spherical polydispersion} was first investigated extensively
by Deirmendjian \cite{Deirmendjian:Mybib}. If the reader comes across terms as ``haze-M'' or ``cloud-C" they are all defined by
Deirmendjian. However, in subsequent years, much investigation was done into the size distribution, composition, 
 refractive index (as a function of wavelength) of atmospheric aerosols.

Our default aerosols are due to the work of Shettle, Fenn, and many others. These may be deemed as ``out of date"
 by some users, which is why users have the option of incorporating aerosols defined
 by their own data and scattering models.

We shall begin with the {\it rural} aerosol as defined by Shettle and Fenn \cite{ShettleFenn:Mybib}. First we write down
the standard form of the {\it lognormal} distribution.
\begin{equation}
\rho(r,\mu)=\frac{ e^{-\lbrack (ln \> r-\mu)^2/2 \sigma^2 \rbrack} }{ r \sigma \sqrt{2 \pi}}.
\end{equation}
Here $\mu$ is the log of the mode radius $r_m$. The skewness of the distribution
 increases with the standard deviation $\sigma$.
The moments are given by
\begin{equation}
\mu_k= \int_0^\infty r^k \rho(r) dr=e^{\mu k +k^2 \sigma^2},
\end{equation}
The rural aerosol is bi-modal, and {\it both modes} consist of two types of aerosol. One is a water
soluble aerosol, and the other is ``dust like".
 Now, in \cite{ShettleFenn:Mybib} the two mode radii $r_m$ are 0.005$\mu m$
and $0.5 \mu m$ respectively. The pdf for the bimodal distribution is just
\begin{equation}
\rho(r,\mu_1, \mu_2)=\alpha \rho(r, \mu_1)+\beta \rho(r, \mu_2)
$$   $$
\alpha+\beta=1, \> \alpha >0,  \> \beta >0.
\end{equation}
In this paper, the values of $\alpha$ and $\beta$ were $1-2.5 \times 10^{-6}$ and $2.5 \times 10^{-6}$.
The casual reader mat think these vastly different values mean that the large mode radius part
of the distribution can be ignored. However, a rough rule of thumb is that the scattering cross
section grows with the square of the particle size, so the small proportion of large particles may 
scatter as much light as the large proportion of small scatterers.

In a later paper Shettle and Fenn \cite{ShettleFenn2:Mybib} look at the effect of humidity on the rural aerosol.
The water soluble type of aerosol will grow in size as the humidity increases.
Such an aerosol is called {\it hygroscopic}.
The first difference is that the small mode radius is now much larger,  and the value
of $\beta$ has increased to $1.25 \times 10^{-4}$. The author believes these latter figures are
 nearer to an accurate description. 
 In \cite{ShettleFenn2:Mybib}. the following radii for the two modes for rural aerosols are 
tabulated.
\begin{center}
\begin{tabular}{| c | c | c | }
\hline
Relative Humidity&  $r_1 \mu m$ & $r_2 \mu m$ \\
\hline
 0 \% &  0.02700 & 0.4300 \\
 50\% &  0.02748 & 0.4377 \\
 70\% &  0.02846 & 0.4571 \\
 80\% &  0.03274 & 0.5477 \\
 90\% &  0.03884 & 0.6462 \\
 95\% &  0.04238 & 0.7078 \\
 98\% &  0.04751 & 0.9728 \\
 99\% &  0.05215 & 1.1755 \\
\hline
\end{tabular}
\end{center}
This rural aerosol is a mixture, which is defined to be a non
 hygroscopic aerosol (30\% dust like) and the hygroscopic water soluble aerosol
(70\%) which grows with increasing humidity.
 Suppose we  take the 99\% values, we {\it might}  take this to mean that
 $0.05215=0.7 r_h+0.3 r_{dry}$. That is to say we might take the mode 
radius of the dust (which doesn't grow with humidity) to be the same
 as the dry mode radius
of the water soluble aerosol, and then take the mode radius of the aggregate
to be a weighted sum of the swollen hygroscopic aerosol and the dry dust aerosol.
 In which case, we would have $r_h=0.06293 \mu m$
for the small particle mode
 and $1.495 \mu m$
for the large particle mode. (Incidentally, hygroscopic aerosols can display
hysteresis \cite{Samparta:Mybib}, so knowledge of the humidity doesn't necessarily give
us a perfect handle on the size parameter.)

There is further confusion here: the hygroscopic aerosol is taken to be a mixture
 of ammonium sulphate, calcium sulphate, and ``organic matter". The complex
refractive index of ammonium sulphate aerosol and ``water soluble" aerosol is tabulated.
It is clear from the data that ammonium sulphate is not in the mixture for water
soluble aerosol (or that it is a negligible proportion --- which is unlikely.)
It is unclear whether ``water soluble" {\it is} calcium sulphate or some mixture
which may or may not include calcium sulphate.

Also though ammonium sulphate is readily soluble, calcium sulphate
is only weakly soluble. So if calcium  sulphate aerosols grow with humidity, they must
act (mostly) as a solid core surrounded by a weak solution of of calcium sulphate.

So, how is one to use Mie theory with this data in order to obtain the model
optical properties of the aerosol? Ideally, we would need want the complex
refractive index as a function of wavelength and size distribution of each and every component.
Not only this, we would want to know the details of how each hygroscopic component
changes with humidity.


From HITRAN,  tables for the complex refractive index as a function of wavelength
are published for the water soluble component, dry ammonium sulphate, and a ``dust like" component
and  water contained in the file named ``shettle.dat".  The data for
the water soluble component are for low humidity. However as the
aerosols grow, they have more and water content. As we do the Mie
calculations for different humidities, we need the refractive index of a mixture
of  water and the disolved water soluble aerosol. 


We use Shettle and Fenn's parametrisation of the
{\it water activity} $a_w$ which is related to the surface tension as 
a function
of the particle radius. This radius is in itself a function of the water
 activity. We have
\begin{equation}
a_w=H \exp \left ( -\frac{0.31469}{r(a_w) T} \right).
\end{equation}
Here $H$ is the humidity scaled to (0,1), and  $T$ the absolute temperature, and $r$ is the particle
size in micrometres.
On top of this we have
\begin{equation}
r(a_w)= r_{dry}\sqrt[3]{1+\rho \frac{ m_w(a_w)}{m_{dry}}}
\end{equation}
These equations were solved for the "wet radius" $r_w$ using data tabulated by H\"anel \cite{Hanel:Mybib}. Then Shettle and Fenn
use
\begin{equation}
n=n_w+(n_{dry}-n_w) \left ( \frac{r_{dry}}{r_h} \right )^3.
\end{equation}
This is the resulting refractive index for a completely dissolved mixture. 
(Which is hardly possible for calcium sulphate.)

So: it is not clear how Shettle and Fenn proceeded, but they say ``To reduce the
calculations for the current models, which now are done as a function of
humidity, the individual aerosol particles are considered to be a homogeneous
mixture of the different types of substance - as many natural aerosols are. The
resulting  refractive index for the composite rural aerosol is given
 in Table 4a and 4b. However Bergstrom has argued that using such mean 
refractive indexes  in determining the optical properties will result in errors." Shettle and 
Fenn indicate they have made calculations indicating that the errors
are acceptably small (~5\% with a maximum of 16\%). Oddly, although Shettle and Fenn tabulated
the rural aerosol refractive index as a function of humidity, they did not tabulate
the water soluble or ammonium sulfate aerosol refractive index as a function of
humidity.

We shall proceed by using the aggregate refractive index and mode radius 
provided by Shettle and Fenn, which we reproduce in the Appendix B. 
As a note of caution, these data were typed on a bad typewriter in the original 
data (some characters are difficult
to read) and were entered manually by the author. Errors are quite possible, however
 that may be, they should not  not lead to
large error in extinction coefficient as a function of wavelength.


\newpage

\appendix

\section{Voigt Profiles and $\kappa$-Distributions} 

\subsection{Non Grey Absorption}

In many cases, the absorption of light can be modelled adequately
using Beer's law. Here the transmittance of light, with a wavelength
range of $\lambda$ to $\lambda+\Delta \lambda$, and through a mass
of gas $m$ with an absorption coefficient $\kappa$ is given by
\begin{equation}
    T=exp(-\kappa\>m).
\end{equation}
The assumes that all photons in the wavelength range ``see" the same
$\kappa$. When this is true the material is said to be ``grey".
If $\kappa$ varies very rapidly as a function of wavelength
then Beer's law cannot apply, and the material is said to be ``non-grey".
In atmospheric applications $m$ is usually given in terms of molecules
 per square centimetre, and so $\kappa$ has units of area.


The function $\kappa(\tilde{\nu})$ is obtained from
\begin{equation}
    \kappa(\tilde{\nu},p,T)=\sum^I S_I(\tilde{\nu},T) f_I(\tilde{\nu},p,T),
\end{equation}
where $\kappa$ is the absorption coefficient $(cm^{2})$, $S_I$
is the line intensity $(cm)$ of the $I$th line, and $f_I$
is the normalised line shape for the $I$th line.
The units given here are appropriate for use with the HITRAN database
\cite{RothmanETAL:Mybib}.
(This can be obtained via the website http://cfa-www.harvard.edu/hitran.)
Other variables are the (vacuum) wavenumber $\tilde{\nu}$ $(cm^{-1})$, the temperature $T$ (Kelvin),
and pressure $p$ ($Pa$). For an individual line, centred at $\tilde{\nu}_0$, 
\begin{equation}
    \kappa(\tilde{\nu},p,T)=\kappa_0 V(x,y)=  \kappa_0 \frac{y}{\pi} \int_{-\infty}^{\infty} \frac{exp(-t^2)}{y^2+(x-t)^2} d\>t.
\end{equation}
Here V(x,y) is the {\it Voigt function} and $\alpha_D$ is the half width for Doppler broadening. This is a convolution of the
Doppler and Lorentz profiles. The details of the calculation of this function and the {\it HUMLIK} program
 are given by Wells \cite{BobWells:Mybib}.

In this notation, if $S(T)$ is the temperature dependent line strength, 
\begin{equation}
   \kappa_0= \frac{S(T)}{\alpha_D(T)} \sqrt{\frac{ln2}{\pi}},
\end{equation}
\begin{equation}
   x= \frac{\tilde{\nu}-\tilde{\nu}_0}{\alpha_D(T)} \sqrt{ln2},
\end{equation}
\begin{equation}
   y= \frac{\alpha_L(p,T)}{\alpha_D(T)} \sqrt{ln2}.
\end{equation}
The Doppler width (half width at half maximum) $\alpha_D$ and the Lorentz width $\alpha_L$ are given by
\begin{equation}
   \alpha_D(T)= \frac{\tilde{\nu}_0}{c}\sqrt{ \frac{ 2 k T}{m}ln 2}, 
\end{equation}
and 
\begin{equation}
   \alpha_L(p,T)= \alpha_L(p_0,T_0)\frac{p}{p_0} \left ( \frac{T_0}{T} \right)^n.
\end{equation}
There are slightly differing formula depending on whether the width is half or full, or whether
the value of Doppler width is quoted at half maximum of $1/e$ of the maximum; some authors
incorporate the $y/\pi$ into $\kappa_0$ but this form leaves the $V$ function un-normalised.
 Also $c$ is the speed of light {\em in vacuo} ($ cm s^{-1}$), $k$ is Boltzmann's
constant $(J K^{-1})$, and $m$ is the mass of the molecule ($kg$). Lastly $p_0$ and $T_0$
are reference pressures and temperatures, and $n$ is a dimensionless 
coefficient of temperature dependence. In the lower atmosphere, where pressure broadening dominates over Doppler
broadening, $k$ can be approximated by the Lorenz profile
\begin{equation}
    \kappa(\tilde{\nu},p,T)=\frac{S(T)}{\pi} \frac{\alpha_L}{ (\tilde{\nu}-\tilde{\nu}_0)^2+\alpha_L^2}.
\end{equation}
In the upper atmosphere, Doppler broadening dominates over pressure broadening, which has a line shape
\begin{equation}
    \kappa(\tilde{\nu},p,T)=\frac{S(T)}{\alpha_D \sqrt{\pi}}  \exp{\left (-\frac{(\nu-\nu_0)^2}{\alpha^2_D}\right )}. 
\end{equation}
Depending on $x$ and $y$, the $HUMLIK$ code may use either the Lorentz or the Doppler profile rather
than the more expensive process of  calculating the integral. The integral will be calculated for $x$ and $y$ values
that indicate that neither Doppler or pressure broadening dominate completely.


The line intensity's temperature dependence, for a transition from state $\eta$
to $\eta^\prime$ is given by
\begin{equation}
    S_{\eta \eta^\prime}=\frac{h \tilde{\nu}_{\eta \eta^\prime}}{c}\frac{n_\eta}{N}
\left ( 1-\frac{g_\eta n_{\eta^\prime}}{g_{\eta^\prime} n_\eta} \right ) B_{\eta \eta^\prime}.
\end{equation}
The prime demotes the upper state, the $g$s are state statistical weights, the
$n$'s are the state populations and N is the molecular number density. The
transition frequency converted to wavenumber is $\tilde{\nu}_{\eta \eta^\prime}$, and $B$ is
the Einstein $B$ coefficient. In thermodynamic equilibrium this simplifies to
\begin{equation}
    S(T)_{\eta \eta^\prime}=S(T_0)\frac{Q(T_0)}{Q(T)} 
\frac{exp(-c_2 E_\eta /T) \left (1-exp(-c_2 \tilde{\nu}_{\eta \eta^\prime}/T) \right )}
{exp(-c_2 E_\eta /T_0) \left (1-exp(-c_2\tilde{\nu}_{\eta \eta^\prime}/T_0) \right )}.
\end{equation}
Here $E_\eta$ is the lower state energy, $c_2$ is the second radiation
constant $=h c / k$, and $Q(T)$ is the partition function. The latter
is supplied as a table in HITRAN, and the lower state energy is also provided.
The Lorentz width is obtained from
\begin{equation}
\alpha(T,p)= \left (\frac{T_0}{T} \right )^n \left ( \alpha_{air}(p_0,t_0) 
\left (\frac{p-p_s}{p_0} \right) +\alpha_{self}(p_0,t_0) \frac{p_s}{p_0} \right ),
\end{equation}
where  $\alpha_{air}(p_0,t_0), \> \alpha_{self}(p_0,t_0)$, and $n$ are taken from HITRAN
tables, and $p_s$ is the partial pressure. This is a more complicated version of eqn.8
which takes into account the collisions between molecules of the same species
which have a larger effect than collisions with different species due to
resonances; this is most important for oxygen.


Suppose more is required than just the direct transmittance $T$, and
wanted to find the radiance field at the TOA (Top Of Atmosphere) say.
It is possible, given the solar spectral irradiance curve, to find
the radiance in a given direction, for a particular solar position.


An earlier method of coping with the non-grey nature of the atmosphere was to use band models. These are dealt with in well known books by Goody, and by Liou
 \cite{Liou:Mybib} \cite{GoodyYung:Mybib}. In some applications these have the merit of capturing the non-grey nature of the atmospheric radiation in tables which are small in size. However, where multiple scattering calculations are required the band models in themselves are of no use. 

If greater accuracy is required and/or multiple scattering takes place, other 
methods must be used. Exponential sum fitting is one approach 
\cite{WisEvans:Mybib}. An early approach was to calculate the photon path length distribution \cite{WMIrvine:Mybib}  \cite{BakanQuenzel:Mybib} \cite{BakanKoepke:Mybib}. It was realised that this was related to the inverse Laplace transform of the atmospheric transmittance. That is, the $\kappa$ distribution function is the inverse Laplace transform of the atmospheric transmittance with the mass of gas as the transform variable.
\begin{equation}
T(m)=\int_0^\infty f(\kappa) e^{-\kappa m} \> d \kappa
\end{equation}
Then the  inverse transform  $f(\kappa)$ is known as the $\kappa$ distribution.

The $\kappa$ distributions of the Malkmus band model are given by Goody\cite{Goody:Mybib}. The $\kappa$ distribution for the exponential band model is given by Domoto \cite{Domoto:Mybib}, and by Godsalve 
\cite{GodsalveBand:Mybib} in a form that is far more efficient for computation.

If more accuracy is required we must then return to the actual details of the spectra. We must directly calculate the $\kappa$ distribution, and in a multiple layer atmosphere with varying temperature and pressure, we must use the cumulative distribution as discussed below.



\subsection{The $\kappa$- and Correlated-$\kappa$ approach}

The correlated $\kappa$ approach is given in some detail in \cite{GoodyWest:Mybib} \cite{LacisOinas:Mybib} \cite{FuLiou:Mybib} \cite{RoseKratz:Mybib} \cite{
MarinBuckuis:Mybib}. We shall just look at the basic principles here.

On looking at Fig.3, it can be seen that the same values of $\kappa$ are repeated
many times over. Therefore, if only an average of many calculations is required
rather than the full detail of Fig.2, it is clear that there is an opportunity
for reducing the number of calculations needed drastically.
\newpage
\vspace*{11cm}
\begin{figure}[htb]
\special{psfile=Fig3.ps vscale=64 hscale=71 hoffset=10 voffset=40}
\caption{ The fraction of photons that ``see" an
absorption coefficient between $\kappa$ and $\kappa+ \Delta \kappa$.}
\end{figure} 

So, if   radiance values were calculated for one wavelength
with an absorption coefficient of $\kappa$, then several other wavelengths
have values of $\kappa$ very close to this value, and as an approximation, they
can be lumped together in order to save CPU time (which can be considerable). If this is done for the
whole range of $\kappa$ values in the interval, then each radiance
must be added in a weighted sum. The weight is simply the fraction of the
$\lambda$ interval that represents the subinterval of $\kappa$ in the weighted 
sum. In other words the weight is the probability that a photon picked at
random wavelength between $\lambda$ and $\lambda+\Delta \lambda$ `sees' 
an absorption coefficient between $\kappa$ and $\kappa+\Delta \kappa$.
If $Q$ is any radiative quantity, then in the continuum limit, the average
$\overline{Q}$ is given by
\begin{equation}
    \overline{Q}=\int_0^\infty f(\kappa^\prime)  Q(\kappa) d \kappa
\end{equation}
where $f(\kappa^\prime)$ is the probability density of finding a 
$\kappa$ in the range $\kappa$ and $\kappa+\Delta \kappa$.
For instance, the transmittance is
\begin{equation}
    \overline{T}=\int_0^\infty f(\kappa^\prime) \> exp(-\kappa \>m) d \kappa.
\end{equation}

In practice, the integrals are replaced by discrete sums, and the function $f$ is also
discrete.
Suppose the function $\kappa_i(\lambda_i)$ is found for a large number
of $i=1,N$ at evenly spaced intervals $\delta \lambda=\Delta \lambda / N$
in the required wavelength range. 
Even if $N$ is large enough to resolve the spectrum, there may be gaps 
where the difference between successive $\kappa$ is larger than the
chosen bin size for $\kappa$. These gaps are unpredictable, and the
 same computer code must
find the discrete probability density function for different gases,
pressures and temperatures. Because of this, it is preferable to choose
 that  $M$ regular bins  for the $\kappa$ (subscript $i$), and values of $\lambda$ (subscript $j$) so that
the grid on $\lambda$ to $\lambda+\Delta \lambda$ is
not  regular. Once this is done, we have $M$ values
for $\kappa_i$ and an  n unpredictable $N^\prime$ values of $\lambda_j$. The

\vspace*{12.5cm}
\begin{figure}[htb]
\special{psfile=Fig4b.eps vscale=64 hscale=71 hoffset=10 voffset=40}
\caption{It is better to choose irregular bins over $\lambda$ and regular bins
 over $\kappa$.}
\end{figure} 



The function $H_n$ is defined as follows.
\begin{equation}
   H_n=\left \lbrace 
         \begin{array}{ll}
 1 & \mbox{if $n \delta \kappa < \kappa < (n+1) \delta \kappa$}  \\
                0   &  \mbox{otherwise.}  
         \end{array} \right \rbrace
\end{equation}
Here $n$ ranges from 0 to $M$. Thus, for any given $n$, the $\kappa$ distribution 
function is given by
\begin{equation}
f(\kappa)\vert_{(n+1/2)\delta \kappa}=\frac{1}{\lambda_2-\lambda_1} \sum_{j=1}^{j=N^\prime} H_j(n) \delta \lambda_j,
\end{equation}
 which is the fraction of the wavelength interval that is represented by the $n$th bin.
The $\delta \lambda$ are the fractions of the total wavelength range associated 
with each of the $\lambda_i$. Clearly
\begin{equation}
\sum_{n=0}^{n=M} f_n=1.
\end{equation}
Given that a discrete approximation of $f(n)$ is calculated, the $\kappa$ distribution
function can be used to calculate any radiative quantity via eqn.13. However there is
a real snag. In a real atmosphere, there are variations in temperature and pressure
as a function of height. In a single layer, it can be said that a certain fraction
of photons see such and such a $\kappa$ value, but when these photons enter another
layer at a different temperature and pressure, there is no way of saying what $\kappa$
values should be assigned in the second layer. It has been shown that, for the Lorentz
profile and a few others, that this problem can be overcome by using the cumulative
distribution instead, i.e.
\begin{equation}
g(k)=\int_0^k f(\kappa^\prime) \> d \kappa^{\prime}.
\end{equation}
Then eqn.14 transforms into
\begin{equation}
\overline{T} =\int_0^1 exp(-\kappa(g) m) dg, 
\end{equation}
or in general
\begin{equation}
\overline{Q}= \int_0^1 Q(\kappa(g)) dg. 
\end{equation}
\vspace*{11.5cm}
\begin{figure}[htb]
\special{psfile=Fig5.ps vscale=64 hscale=71 hoffset=10 voffset=40}
\caption{The two cumulative distributions correspond
to different pressures and temperatures.}  
\end{figure}
So, for certain absorption line profiles, the $\kappa$ values used in a quadrature
approximation to eqns.18 and 19 are 100\% correlated. All the photons that
see the value of $\kappa_{1 \alpha}$ in one layer see the value $\kappa_{1 \beta}$
in the other. Because of this, when the cumulative distribution is used rather than using the $\kappa$ distribution directly, the method may be described as the {\it correlated $\kappa$} method.  In general this is not exactly true, but the correlations
are high enough for this correlated $\kappa$ method to be a good approximation. 

\subsection{Snags}

All seems well so far, but this is not the case if actual radiance values
are needed in some wavelength interval. This is because the solar spectral
irradiance $S(\lambda)$ will vary across the wavelength interval. what is more, if
a prediction of a given instrument reading is required, the instrument response
function $R_{esp}(\lambda)$. If exact calculations are required, each
$\kappa$ value `sees' a whole range of response function values, so in a numerical
approximation of eqn.18
\begin{equation}
\overline{T} =\sum_{p=1}^{p=P} w_p exp(-\kappa_p(g) m) 
\end{equation}
would  turn into a double summation
\begin{equation}
\overline{T} =\sum_{p=1}^{p=P} \sum_{q=1}^{q=Q} w_q w_p R_{esp \> q} exp(-\kappa_p(g) m) 
\end{equation}
in order to take into account the range of response function variation across each $\kappa_p$.
This would then  turn into a triple sum when the solar variation was included.  This
could easily turn out to be just as expensive as doing the fine detail calculations
of Fig.2. Instead, we might use  the approximation that
\begin{equation}
\overline{T} =\sum_{p=1}^{p=P} \overline{R_{esp}\> S}_p w_p exp(-\kappa_p(g) m). 
\end{equation}
Here $\overline{R_{esp}\> S}_p$ is the mean value of the solar response 
times the response function calculated for each $\kappa_p$. This goes some way
to taking into account how the absorption coefficient varies across the
response function.

The final problem is how to deal with the radiance at the top of the atmosphere.
\begin{equation}
\overline{I} =\sum_{p=1}^{p=P} \overline{R_{esp}\> S}_p w_p I \left ({\kappa_p,R} \right ),
\end{equation}
where $R$ is the reflectance at the ground level. The problem here as things stand
is that if $R$ varies with wavelength in the wavelength interval covered by
the response function, then it is longer a matter calculating predefined 
weights for a given problem. The solution of the radiative transfer problem itself
depends on the reflectance spectrum as well as the $\kappa$ values
inserted into each layer of atmosphere. What is needed is a list of what reflectance
value, on average, is needed for each $\kappa_p$, then
\begin{equation}
\overline{I} =\sum_{p=1}^{p=P} \overline{R_{esp}\> S}_p w_p I \left ({\kappa_p,R_p}\right ).
\end{equation}

\subsection{How Dors1 Does the Calculations}

We are using the $HUMLIK$ subroutine to calculate the line-shape. This has an input vector $X$ of
 wave numbers and a
corresponding output vector $K$. (The actual calculations are done in terms of wave number rather than wavelength,
 but we shall still sometimes speak as if we were doing it wavelengths.)
It would be nice if we could just calculate the $\kappa$ distribution for each
line in the wavelength interval and add them all up to get the required $\kappa$ distribution.
Unfortunately this won't work. To see this consider a spectrum consisting of just two overlapping Lorentz line shapes.
 It is easy to show that the peaks of this ``toy spectrum" are not at the line centres of the individual
lines. Not only that, the maximum value of $\kappa$ will be larger than the maximum value for each individual line.
That is --- the spectrum has ``bins" of $\kappa_N \rightarrow \kappa_{N+1}$ (where $\kappa_N$ is $N$ times the bin size)
 that the $\kappa$ distribution of the individual lines don't have: in other words, the $\kappa$ distribution for
the spectrum is {\it not} the sum of the $\kappa$ distributions for each line.
This means that we must find the $\kappa$ distribution from the detailed spectrum in each layer rather
than considering $\kappa$ distributions of individual lines.  We shall swap over to wavenumber space in the following.

The calculation of a spectrum present us with some difficulties.
 First, the lines may not be equally spaced, and the width
and strength may vary from line to line. Alongside this, Voigt function calculations can take up
a lot of time. We do not want to use an extremely small but regular wavelength interval 
in order to capture the spectrum. 

Can we call $HUMLIK$ for each line and calculate the spectrum {for all the $x$ values
passed to $HUMLIK$ for all the lines}? Suppose that a set of initial $X$ vectors (one for each line)
consist of a
the wavenumber of the line centre and equally spaced $x$ up to the cut-off on either side.
Suppose that we call $HUMLIK$ to get the corresponding $K$ vectors for each line.
Then we need a second set of  $X$ vectors which include the values of $x$ for all the lines
on either side overlapping the current line. Suppose there is just one overlap and two lines.
First we find an initial $X_{01}$ for line 1, and $X_{02}$ for line 2. Suppose we calculate the
corresponding $K$ vectors. Now we call $HUMLIK$ again with an $X$ vector consisting of those
$X_{02}$ that lie in the span of $X_{01}$ and add the new $K_{11}$ values to the pre existing $K_{02}$.
There is a similar process for line 2. The thing is there may be many lines overlapping each other
 --- especially for the slowly decaying Lorentz shapes. This is going to be a mess with just three
overlapping lines. Quite apart from the mess, we shall need the $X$ values to be sorted which adds
to the computational cost again. This doesn't appear to be an option after all. We could try
things like interpolation and merging $x$ values that are very close together, but the author doubts
 if it would be worth it.

 Instead we might choose to adapt the wavelength interval according to
the width of a close by line. If we do this, we shall find that our spectrum is calculated at different
points (and numbers of points) from layer to layer as we move from the T.O.A. down to the ground 
because of increasing pressure broadening. This is not a {\it real} difficulty as it is the $\kappa$
distribution we are after. So we proceed as follows.
\begin{verbatim}
                1.  get first line's wavenumber.
                2.  if( wavenumber-cutoff < nu1X ){start at nu1X}
                    else{ start at wavenumber -cutoff}
                3   nustep=width/istep
                    loop{ over all lines     
                     push nu to SpectrumWaves (C++ vector ) in steps of
                     nustep up to line centre from start}
                4.   push line centre to Spectrum waves
                     if(line+cutoff < next line-next cutoff){
                               next start=nextline-(its cutoff) 
                               stop= line+cut off}
                     else{
                        if(next line - next cutoff < current nu+cutoff)
                          {
                          if(next line - 
                                  next cutoff < half way to next line){
                              start=current line
                              stop=half way  between line and next line}
                          }else{
                              start=current line
                              stop=next line- next cutoff
                          }
                     } 

                5.   loop{continue stepping until stop
                          adding to SpectrumWaves as we go along}
                6.    change nustep according to next line width
   
                7.   line=next line
 
                   }
                8.  declare vector of kayvalues[SpectrumWaves.size] 
                    and zero each element.
\end{verbatim} 
All we have is a set of wavelengths. We shall use these to get consecutive (ordered) $X$ vectors to call
$HUMLIK$ with. We add the $K$ values to the appropriate elements of our $kayvalues$ array.
So we have our spectrum with no need for sorting and (hopefully something like) a minimum of computational
cost given our cut-off values and resolution given by istep. 



\section{Atmospheric Profiles}


\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=TempProfs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Temperature as a function of height for the 6 AFGL atmospheres.
S.A. is sub-arctic, M.L. is mid-latitude, and we have S.S. for Spring/Summer
and A.W. for Autumn/Winter.}
\end{figure}

\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=PressProfs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Pressure (mbar) as a function of height for the 6 AFGL atmospheres.}
\end{figure}


\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=H2OProfs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Water vapour as a function of height for the 6 AFGL atmospheres.}
\end{figure}


\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=O3Profs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Ozone as a function of height for the 6 AFGL atmospheres.
 numbered top down. Note that since we are using ppm, the increase in ozone mass per volume at ground level is masked.}
\end{figure}

\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=N2OProfs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Nitreous Oxide as a function of height for the 6 AFGL atmospheres.
 numbered top down.}
\end{figure}


\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=COProfs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Carbon monoxide as a function of height for the 6 AFGL atmospheres.
 numbered top down.}
\end{figure}

\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=CH4Profs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Methane as a function of height for the 6 AFGL atmospheres.
 numbered top down.}
\end{figure}

\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=Gas8-12Profs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Profiles for Gases 8-12 (Table 1)}
\end{figure}

\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=Gas13-17Profs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Profiles for Gases 13-17 (Table 1)}
\end{figure}

\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=Gas18-23Profs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Profiles for Gases 18-23 (Table 1)}
\end{figure}

\newpage
\vspace*{10cm}
\begin{figure}[htb]
\special{psfile=Gas24-28Profs.ps voffset=.0 hoffset=50.0 hscale=50 vscale=50}
\caption{Profiles for Gases 24-28 (Table 1). Phosphine has a constant concentration of $10^{-14}ppm$}
\end{figure}


\section{Complex Refractive Index Tables}

\begin{center}
\begin{table}
\begin{tabular}{| c | c | c | c | c |  }
\hline
 $\lambda \mu m$ & 0\%  & 50\%  & 70\%  &  80\%  \\
\hline
0.2000 & 1.530 -7.00e-2  & 1.523 -6.64e-2 &     1.510 -5.98e-2 & 1.471 -3.92e-2 \\
0.2500  &  1.530 -3.00e-2  &  1.521 -2.85e-2  &  1.505 -2.56e-2  &  1.456 -1.68e-2   \\
0.3300  &  1.530 -6.00e-3  &  1.521 -7.59e-3 &   1.504 -6.83e-3  &  1.450 -4.49e-3  \\
0.3371  &  1.530 -5.90e-3  &  1.520 -5.60e-3  &  1.503 -5.04e-3   & 1.449 -3.31e-3 \\
0.4000 &   1.530 -5.90e-3  &  1.520 -5.60e-3  &  1.502 -5.04e-3  &  1.446 -3.31e-3 \\
0.4880  &  1.530 -5.90e-3  &  1.520 -5.60e-3  &  1.501 -5.04e-3  &  1.444 -3.31e-3 \\
0.5145  &  1.530 -5.90e-3 &   1.520 -5.60e-3  &  1.501 -5.04e-3  &  1.444 -3.31e-3  \\
0.5500  &  1.530 -6.60e-3  &  1.520 -6.26e-3  &  1.501 -5.63e-3  &  1.443 -3.70e-3  \\
0.6328  &  1.530 -6.60e-3 &   1.520 -6.26e-3  &  1.501 -5.63e-3  &  1.443 -3.70e-3  \\ 
0.6943 &   1.530 -7.30e-3 &   1.520 -6.92e-3  &   1.501 -6.23e-3 &   1.443 -4.09e-3  \\ 
0.8600 &   1.520 -1.08e-2  &  1.510 -1.02e-2  &  1.492 -9.22e-3  &  1.436 -6.06e-3  \\ 
1.0600  &  1.528 -1.43e-2  &  1.510 -1.36e-2  &  1.492 -1.22e-2  &  1.435 -8.02e-3  \\ 
1.3000  &  1.495 -1.64e-2  &  1.486 -1.56e-2  &  1.470 -1.40e-2  &  1.419 -9.21e-3  \\
1.5360  &  1.477 -1.85e-2  &  1.469 -1.76e-2  &  1.454 -1.58e-2  &  1.407 -1.04e-2 \\  
1.8000  &  1.421 -1.43e-2  &  1.415 -1.36e-2  &  1.405 -1.22e-2  &  1.373 -8.07e-3  \\ 
2.0000  &  1.372 -8.00e-3  &  1.369 -7.65e-3  &  1.362 -6.99e-3  &  1.343 -4.97e-2 \\  
2.2500 &  1.360 -9.70e-3   & 1.357 -9.22e-3   & 1.350 -8.34e-3  &  1.330 -5.61e-2  \\
2.5000  &  1.348 -1.11e-2  &  1.344 -1.06e-2  &  1.335 -9.83e-3  &  1.310 -6.99e-2 \\  
2.7000  &  1.334 -4.24e-2  &  1.326 -1.12e-2  &  1.313 -3.90e-2  &  1.270 -3.21e-2  \\ 
3.0000  &  1.342 -1.90e-2  &  1.343 -1.20e-2  &  1.346 -5.60e-2  &  1.355 -1.30e-1  \\ 
3.2000 &   1.367 -8.60e-3  &  1.373 -1.29e-2  &  1.383 -2.09e-2  &  1.416 -4.54e-2  \\
3.3923 &   1.379 -8.80e-3  &  1.381 -9.40e-3 &   1.365 -1.05e-2  &  1.398 -1.39e-2 \\ 
3.5000 &   1.399 -6.80e-3  &  1.399 -6.03e-3  &  1.399 -7.18e-3  &  1.399 -7.94e-3  \\ 
3.7500 &   1.397 -6.20e-3  &  1.396 -5.97e-3 &   1.393 -5.72e-3  &  1.385 -4.96e-3 \\  
4.0000 &   1.397 -7.10e-3  &  1.394 -6.97e-3 &   1.390 -6.73e-3  &  1.377 -6.06e-3  \\
4.5000 &   1.400 -1.33e-2  &  1.397 -1.33e-2 &   1.390 -1.33e-2  &  1.370 -1.33e-2  \\ 
5.0000 &   1.390 -1.32e-2  &  1.387 -1.32e-2  &  1.380 -1.31e-2  &  1.361 -1.26e-2  \\ 
5.5000 &   1.374 -1.89e-2  &  1.370 -1.85e-2  &  1.363 -1.78e-2  &  1.341 -1.57e-2  \\ 
6.0000 &   1.332 -2.72e-2  &  1.329 -2.13e-2 &   1.322 -3.89e-2 &   1.303 -6.23e-2  \\ 
6.2000 &   1.343 -3.06e-2 &   1.324 -3.36e-2 &   1.346 -3.90e-2  &  1.352 -5.58e-2  \\ 
6.5000 &   1.361 -3.57e-2 &   1.360 -3.59e-2 &   1.358 -3.62e-2  &  1.351 -3.72e-2 \\  
7.2000 &   1.400 -6.55e-2 &   1.395 -6.38e-2 &   1.387 -6.06e-2  &  1.361 -5.08e-2 \\ 
\hline
\end{tabular}
\caption{Short wavelength values of the complex refractive index of the small rural aerosol mode at low humidity}
\end{table}
\end{center}

\begin{center}
\begin{table}
\begin{tabular}{| c | c | c | c | c |  }
\hline
 $\lambda \mu m$ & 0\%  & 50\%  & 70\%  &  80\%  \\
\hline 
7.9000 &   1.185 -5.75e-2  &  1.191 -5.63e-2 &   1.201 -5.40e-2  &  1.233 -4.71e-2  \\ 
8.2000 &   1.046 -9.33e-2  &  1.058 -6.93e-2  &  1.081 -6.39e-2  &  1.151 -6.71e-2  \\ 
8.5000 &   1.300 -1.78e-1 &   1.299 -1.70e-1  &  1.297 -1.57e-1  &  1.290 -1.16e-1  \\ 
8.7000 &   2.100 -2.33e-1  &  2.057 -2.23e-1  &  1.979 -2.04e-1  &  1.736 -1.47e-1   \\
9.0000 &   2.302 -3.01e-1  &  2.249 -2.88e-1  &  2.150 -2.63e-1  &  1.845 -1.86e-1  \\
9.2000 &   2.056 -3.39e-1  &  2.015 -3.24e-1  &  1.939 -2.95e-1  &  1.704 -2.08e-1   \\
9.5000 &   1.884 -1.61e-1  &  1.851 -1.55e-1  &  1.790 -1.44e-1  &  1.602 -1.10e-1   \\
9.8000 &   1.831 -1.15e-1  &  1.800 -1.12e-1  &  1.743 -1.05e-1  &  1.567 -8.56e-2  \\ 
10.000 &   1.799 -1.12e-1  &  1.769 -1.08e-1  &  1.714 -1.03e-1  &  1.544 -8.49e-2   \\ 
10.591 &   1.718 -8.50e-2  &  1.690 -8.41e-2  &  1.639 -8.24e-2  &  1.481 -7.73e-2  \\
11.000  &  1.690 -6.65e-2  &  1.662 -6.81e-2 &   1.611 -7.09e-2  &  1.454 -7.98e-2  \\
11.500 &   1.646 -6.29e-2 &   1.619 -6.70e-2  &  1.570 -7.45e-2 &   1.418 -9.76e-2   \\
12.500 &   1.587 -6.41e-2 &   1.563 -7.41e-2 &   1.519 -9.26e-2 &   1.383 -1.50e-1   \\
13.000 &   1.575 -6.85e-2 &   1.553 -8.07e-2  &  1.512 -1.03e-1  &  1.387 -1.72e-1   \\
14.000 &   1.548 -7.66e-2 &   1.531 -9.17e-2  &  1.499 -1.20e-1  &  1.400 -2.05e-1   \\
14.800 &   1.479 -1.00e-1 &   1.468 -1.15e-1  &  1.447 -1.43e-1 &   1.382 -2.30e-1   \\
15.000 &   1.465 -1.70e-1 &   1.455 -1.82e-1 &   1.436 -2.04e-1  &  1.379 -2.72e-1   \\
16.400 &   1.705 -1.42e-1  &  1.687 -1.57e-1 &   1.653 -1.84e-1  &  1.547 -2.67e-1   \\
17.200 &   1.945 -1.98e-1  &  1.916 -2.10e-1  &  1.853 -2.32e-1  &  1.699 -2.99e-1   \\
18.000  &   1.878 -1.61e-1 &   1.855 -1.74e-1 &   1.811 -1.99e-1 &   1.678 -2.77e-1  \\
18.500   &  1.787 -1.55e-1 &   1.768 -1.69e-1 &   1.737 -1.94e-1 &   1.636 -2.72e-1   \\
20.000 &   1.988 -2.20e-1  &  1.962 -2.29e-1 &   1.914 -2.45e-1  &  1.765 -2.96e-1   \\
21.300 &   1.973 -2.45e-1  &  1.948 -2.52e-1  &  1.903 -2.65e-1  &  1.761 -3.04e-1   \\
22.500 &   1.978 -2.52e-1  &  1.946 -2.58e-1 &   1.902 -2.69e-1 &   1.766 -3.04e-1   \\
25.000 &   1.907 -2.68e-1  &  1.888 -2.73e-1 &   1.852 -2.81e-1 &   1.742 -3.07e-1   \\
27.900 &   1.855 -2.99e-1  &  1.839 -3.01e-1 &   1.810 -3.05e-1 &   1.721 -3.16e-1   \\
30.000 &   1.814 -3.36e-1  &  1.800 -3.36e-1  &  1.776 -3.35e-1  &  1.698 -3.32e-1   \\
35.000 &   1.914 -4.30e-1  &  1.894 -4.25e-1  &  1.858 -4.16e-1  &  1.746 -3.89e-1   \\
40.000 &   1.932 -5.30e-1  &  1.911 -5.23e-1  &  1.872 -5.09e-1  &  1.761 -4.66e-1  \\
\hline
\end{tabular}
\caption{Long wavelength values of the complex refractive index of the small rural aerosol mode at low humidity}
\end{table}
\end{center}

\begin{center}
\begin{table}
\begin{tabular}{| c | c | c | c | c |  }
\hline
 $\lambda \mu m$   & 90\%  & 95\%  & 98\%  & 99\% \\
\hline
0.2000 &  1.441 -2.35e-2 &    1.431 -1.61e-2  & 1.421 -1.28e-2 & 1.415 -9.71e-3 \\
0.2500  &   1.418 -1.01e-2  &  1.405 -7.76e-3  &  1.393 -5.51e-3  &  1.385 -4.16e-3 \\
0.3300  &    1.410 -2.69e-3 & 1.396 -2.07e-3   & 1.382 -1.47e-3  &  1.374 -1.11e-3 \\
0.3371   &  1.407 -1.98e-3  &  1.393 -1.53e-3  &  1.379 -1.08e-3 &   1.371 -8.19e-4 \\
0.4000   &  1.403 -1.98e-3 &   1.388 -1.53e-3  &  1.374 -1.08e-3  &  1.366 -8.19e-4 \\
0.4880  &   1.401 -1.98e-3  &  1.385 -1.53e-3  &  1.371 -1.08e-3  &  1.362 -8.19e-4 \\
0.5145  &    1.400 -1.98e-3  &  1.385 -1.53e-3  &  1.370 -1.08e-3 &   1.361 -8.19e-4 \\
0.5500  &  1.399 -2.22e-3 &   1.384 -1.71e-3  &  1.369 -1.21e-3   & 1.360 -9.16e-4 \\
0.6328   &   1.399 -2.22e-3  &  1.383 -1.71e-3  &  1.368 -1.21e-3 &   1.359 -9.16e-4 \\
0.6943  &    1.398 -2.45e-3 &   1.383 -1.89e-3  &  1.368 -1.34e-3 &   1.359 -1.01e-3 \\
0.8600   &   1.393 -3.63e-3  &  1.378 -2.79e-3  &  1.364 -1.98e-3  &  1.356 -1.50e-3 \\
1.0600     &  1.391 -4.81e-3  &  1.376 -3.70e-3 & 1.362 -2.63e-3   & 1.353 -1.99e-3  \\
1.3000   &  1.381 -5.53e-3  &  1.367 -4.27e-3 & 1.355 -3.44e-3  &  1.347 -2.31e-3 \\
1.5360  &   1.371 -6.28e-3  &  1.359 -4.86e-3  &  1.347 -4.48e-3  &  1.340 -2.65e-3 \\
1.8000  &    1.349 -4.88e-3  &  1.340 -3.78e-3  &  1.332 -2.72e-3 &   1.327 -2.08e-3 \\
2.0000   &   1.328 -3.52e-3 &   1.323 -2.88e-3  &  1.318 -2.37e-3  &  1.315 -2.06e-3 \\
2.2500   &   1.315 -3.52e-3 &   1.310 -2.80e-3  &  1.304 -2.10e-3  &  1.301 -1.68e-3 \\
2.5000  &    1.290 -4.89e-3  &  1.283 -4.16e-3  &  1.277 -3.46e-3  &  1.273 -3.04e-3 \\
2.7000  &    1.237 -2.69e-2  &  1.226 -2.50e-2  &  1.225 -2.33e-2  &  1.208 -2.22e-2 \\
3.0000  &    1.361 -1.87e-1  &  1.364 -2.07e-1  &  1.366 -2.26e-1  &  1.367 -2.37e-1 \\
3.2000  &    1.441 -6.42e-2 &   1.449 -7.07e-2  &  1.458 -7.70e-2  &  1.463 -8.08e-2 \\
3.3923  &    1.408 -1.65e-2 &   1.411  1.74e-2  &  1.414 -1.83e-2  &  1.416 -1.88e-2 \\
3.5000   &   1.400 -8.53e-3 &   1.400 -8.73e-3  &  1.406 -8.92e-3 &   1.400 -9.04e-3 \\
3.7500   &   1.379 -4.37e-3 &   1.376 -4.17e-3 &   1.374 -3.98e-3  &  1.373 -3.86e-3 \\
4.0000   &   1.366 -5.44e-3 &   1.363 -5.25e-3  &  1.358 -5.06e-3  &  1.357 -4.95e-3 \\
4.5000  &   1.355 -1.34e-2  &  1.350 -1.34e-2  &  1.344 -1.34e-2  &  1.341 -1.34e-2 \\
5.0000  &   1.347 -1.27e-2 &   1.342 -1.26e-2  &  1.337 -1.25e-2  &  1.334 -1.25e-2 \\
5.5000   &   1.324 -1.41e-2  &  1.318 -1.35e-2 &   1.312 -1.29e-2 &   1.309 -1.26e-2 \\
6.0000   &   1.288 -8.02e-2  &  1.282 -8.64e-2 &   1.277 -9.24e-2  &  1.274 -9.59e-2 \\
6.2000   &   1.356 -6.87e-2  &  1.358 -7.32e-2 &   1.359 -7.75e-2  &  1.360 -8.00e-2 \\
6.5000  &    1.346 -3.90e-2  &  1.345 -3.83e-2  &  1.343 -3.86e-2  &  1.342 -3.87e-2 \\
7.2000  &    1.342 -4.33e-2  &  1.335 -4.07e-2  &  1.326 -3.82e-2  &  1.324 -3.87e-2 \\
\hline
\end{tabular}
\caption{Short wavelength values of the complex refractive index of the small rural aerosol mode at high humidity}
\end{table}
\end{center}

\begin{center}
\begin{table}
\begin{tabular}{| c | c | c | c | c |  }
\hline
 $\lambda \mu m$   & 90\%  & 95\%  & 98\%  & 99\% \\
\hline
7.9000  &   1.257 -4.18e-2  &  1.266 -4.00e-2   & 1.274 -3.82e-2  &  1.279 -3.72e-2 \\
8.2000  &    1.205 -5.43e-2 &   1.224 -4.99e-2  &  1.242 -4.56e-2  &  1.253 -4.30e-2 \\
8.5000  &   1.285 -8.40e-2  &  1.284 -7.31e-2  &  1.282 -6.25e-2  &  1.281 -5.62e-2 \\
8.7000  &  1.550 -1.03e-1  &  1.486 -8.83e-2  &  1.424 -7.37e-2  &  1.387 -6.49e-2 \\
9.0000   &   1.611 -1.28e-1  &  1.531 -1.07e-1 &   1.453 -8.78e-2  &  1.406 -7.61e-2 \\
9.2000   &   1.524 -1.41e-1  &  1.462 -1.18e-1  &  1.402 -9.61e-2  &  1.366 -8.28e-2 \\
9.5000   &   1.458 -8.34e-2 &   1.409 -7.44e-2 &   1.361 -6.57e-2  &  1.332 -6.05e-2 \\
9.8000   &   1.431 -7.05e-2 &   1.385 -6.63e-2  &  1.339 -6.02e-2  &  1.313 -5.72e-2 \\
10.000   &   1.431 -7.12e-2 &   1.368 -6.65e-2  &  1.325 -6.20e-2  &  1.299 -5.92e-2 \\
10.591   &   1.360 -7.33e-2 &   1.318 -7.20e-2  &  1.278 -7.06e-2 &  1.254 -6.92e-2 \\
11.000   &   1.333 -8.66e-2 &   1.292 -8.90e-2 &   1.252 -9.12e-2 &   1.228 -9.26e-2 \\
11.500   &   1.301 -1.15e-1  &  1.260 -1.22e-1 &   1.221 -1.27e-1 &   1.198 -1.31e-1 \\
12.500   &   1.279 -1.94e-1  &  1.243 -2.09e-1 &   1.208 -2.23e-1 &   1.187 -2.32e-1 \\
13.000   &   1.290 -2.26e-1  &  1.257 -2.44e-1  &  1.225 -2.62e-1 &   1.206 -2.72e-1 \\
14.000   &   1.324 -2.71e-1  &  1.297 -2.94e-1  &  1.272 -3.16e-1  &  1.257 -3.29e-1 \\
14.800   &   1.332 -2.97e-1  &  1.315 -3.20e-1 &   1.299 -3.42e-1 &   1.289 -3.55e-1 \\
15.000   &   1.336 -3.24e-1  &  1.320 -3.42e-1 &   1.306 -3.52e-1 &   1.297 -3.70e-1 \\
16.400   &   1.467 -3.31e-1  &  1.439 -3.53e-1 &   1.412 -3.75e-1 &   1.396 -3.87e-1 \\
17.200   &   1.574 -3.51e-1  &  1.531 -3.69e-1 &   1.489 -3.87e-1  &  1.464 -3.97e-1 \\
18.000   &   1.576 -3.37e-1  &  1.541 -3.57e-1  &  1.507 -3.77e-1 &   1.486 -3.89e-1 \\
18.500   &   1.559 -3.32e-1  &  1.532 -3.52e-1 &   1.506 -3.72e-1 &   1.491 -3.84e-1 \\
20.000   &  1.651 -3.35e-1   & 1.611 -3.48e-1 &   1.573 -3.61e-1  &  1.550 -3.69e-1 \\
21.300   &  1.653 -3.34e-1  &  1.616 -3.45e-1 &   1.579 -3.55e-1  &  1.558 -3.61e-1 \\
22.500   &   1.662 -3.39e-1 &   1.626 -3.39e-1 &   1.591 -3.48e-1  &  1.570 -3.54e-1 \\
25.000   &   1.657 -3.26e-1 &   1.628 -3.33e-1 &   1.606 -3.40e-1  &  1.583 -3.44e-1 \\
27.900   &   1.652 -3.25e-1 &   1.628 -3.28e-1 &   1.605 -3.31e-1 &   1.591 -3.33e-1 \\
30.000    &  1.639 -3.31e-1  &  1.619 -3.30e-1  &  1.599 -3.29e-1   & 1.567 -3.29e-1 \\
35.000   &  1.660 -3.68e-1  &  1.631 -3.60e-1  &  1.602 -3.53e-1  &  1.585 -3.49e-1 \\
40.000   &  1.658 -4.34e-1  &  1.626 -4.22e-1  &  1.595 -4.12e-1  &  1.576 -4.05e-1 \\
\hline
\end{tabular}
\caption{Long wavelength values of the complex refractive index of the small rural aerosol mode at high humidity}
\end{table}
\end{center}

\begin{center}
\begin{table}
\begin{tabular}{| c | c | c | c | c |  }
\hline
 $\lambda \mu m$   & 0\%  & 50\%  & 70\%  & 80\% \\
\hline
0.2000 & 1.530 -7.00e-2  &  1.523   -6.64e-2  &  1.508   -5.83e-2  &   1.461   -3.39e-2    \\  
0.2500 &  1.530 -3.00e-2 &  1.521   -2.84e-2 &   1.502   -2.50e-2  &   1.443   -1.45e-2   \\  
0.3300 &  1.530 -6.00e-3 &  1.521   -7.59e-3  &  1.500   -6.66e-3  &   1.437   -3.87e-3     \\ 
0.3371 &  1.530 -5.90e-3 &  1.520   -5.59e-3  &  1.499   -4.91e-3  &   1.435   -2.86e-3    \\
0.4000 &  1.530 -5.90e-3 &  1.520   -5.59e-3 &   1.498   -4.91e-3  &   1.431   -2.86e-3    \\
0.4880 &  1.530 -5.90e-3 &  1.520   -5.59e-3 &   1.497   -4.91e-3  &   1.429   -2.86e-3    \\
0.5145 &  1.530 -5.90e-3 &  1.520   -5.59e-3 &   1.497   -4.91e-3  &   1.429   -2.86e-3  \\
0.5500 &  1.530 -6.69e-3 &  1.520   -6.26e-3 &   1.497   -5.49e-3  &   1.428   -3.19e-3   \\
0.6328 &  1.530 -6.60e-3 &  1.520   -6.26e-3 &   1.497   -5.49e-3  &   1.428   -3.19e-3    \\
0.6943 &  1.530 -7.30e-3 &  1.520   -6.92e-3 &   1.497   -6.08e-3 &    1.427   -3.53e-3   \\
0.8600 &  1.520 -1.08e-2 &  1.510   -1.02e-2 &   1.488   -8.99e-3 &    1.421   -5.23e-3   \\
1.0600 &  1.528 -1.43e-2 &  1.510   -1.36e-2 &   1.487   -1.18e-2 &    1.420   -6.92e-3    \\
1.3000 &  1.495 -1.64e-2 &  1.486   -1.56e-2 &   1.466   -1.37e-2  &   1.406   -7.96e-3     \\
1.5360 &  1.477 -1.85e-2 &  1.469   -1.75e-2 &   1.450   -1.54e-2 &    1.395   -9.01e-3    \\
1.8000 &  1.421 -1.43e-2 &  1.415   -1.36e-2 &   1.403   -1.19e-2  &   1.365   -6.98e-3    \\
2.0000 &  1.372 -8.00e-3 &  1.369   -7.64e-3 &   1.361   -6.84e-3  &   1.338   -4.44e-3     \\
2.2500 &  1.360 -9.70e-3 &  1.356   -8.22e-3 &   1.349   -8.14e-3  &   1.325   -4.90e-3    \\
2.5000 &  1.348 -1.11e-2 &  1.343   -1.06e-2 &   1.333   -9.53e-3 &    1.303   -6.27e-3   \\
2.7000 &  1.334 -4.24e-2 &  1.326   -4.12e-2 &   1.310   -3.85e-2 &    1.259   -3.03e-2     \\
3.0000 &  1.342 -1.90e-2 &  1.344   -3.21e-2 &   1.347   -6.14e-2 &    1.357   -1.50e-1    \\
3.2000 &  1.367 -8.60e-3 &  1.373   -1.29e-2 &   1.386   -2.26e-2 &    1.424   -5.18e-2    \\
3.3923 &  1.379 -8.80e-3 &  1.381   -8.40e-3 &   1.386   -1.07e-2 &    1.401   -1.48e-2    \\
3.5000 &  1.399 -6.80e-3 &  1.399   -6.39e-3 &   1.399   -7.24e-3 &    1.400   -8.14e-3   \\
3.7500 &  1.397 -6.20e-3 &  1.396   -5.97e-3 &   1.393   -5.66e-3 &    1.383   -4.76e-3    \\
4.0000 &  1.397 -7.10e-3 &  1.394   -6.97e-3 &   1.389   -6.88e-3 &    1.373   -5.81e-3    \\
4.5000 &  1.400 -1.33e-2 &  1.396   -1.33e-2 &   1.389   -1.33e-2 &    1.365   -1.34e-2    \\
5.0000 &  1.390 -1.32e-2 &  1.387   -1.32e-2 &   1.379   -1.31e-2 &    1.356   -1.28e-2   \\
5.5000 &  1.374 -1.89e-2 &  1.370   -1.85e-2 &   1.361   -1.77e-2 &    1.335   -1.51e-2    \\
6.0000 &  1.332 -2.72e-2  & 1.329   -3.13e-2 &   1.321   -4.06e-2 &    1.297   -6.84e-2   \\
6.2000 &  1.343 -3.06e-2 &  1.344   -3.36e-2 &   1.346   -4.02e-2  &   1.353   -6.02e-2    \\
6.5000 &  1.361 -3.57e-2 &  1.360   -3.59e-2 &   1.357   -3.63e-2 &    1.350   -3.75e-2     \\
7.2000&   1.400 -6.55e-2 &  1.395   -6.38e-2 &   1.385   -5.59e-2  &   1.355   -4.83e-2   \\
\hline
\end{tabular}
\caption{Short wavelength values of the complex refractive index of the large rural aerosol mode at low humidity}
\end{table}
\end{center}

\begin{center}
\begin{table}
\begin{tabular}{| c | c | c | c | c |  }
\hline
 $\lambda \mu m$   & 0\%  & 50\%  & 70\%  & 80\% \\
\hline
7.9000 &  1.185 -5.75e-2 &  1.191   -5.63e-2 &   1.203   -5.35e-2  &   1.241   -4.53e-2     \\
8.2000 &  1.046 -9.33e-2 &  1.058   -8.92e-2 &   1.086   -8.26e-2  &   1.170   -6.27e-2     \\
8.5000 &  1.300 -1.78e-1 &  1.299   -1.70e-1 &   1.296   -1.54e-1  &   1.289   -1.05e-1     \\
8.7000 &  2.100 -2.33e-1 &  2.057   -2.23e-1 &   1.961   -2.00e-1  &   1.673   -1.32e-1    \\
9.0000 &  2.302 -3.01e-1 &  2.248   -2.87e-1 &   2.128   -2.57e-1  &   1.765   -1.66e-1     \\
9.2000 &  2.056 -3.39e-1 &  2.015   -3.24e-1 &   1.922   -2.89e-1  &   1.643   -1.85e-1     \\
9.5000 &  1.884 -1.61e-1 &  1.851   -1.55e-1 &   1.777   -1.41e-1  &   1.553   -1.01e-1     \\
9.8000 &  1.831 -1.15e-1 &  1.800   -1.12e-1 &   1.730   -1.04e-1  &   1.520   -8.04e-2     \\
10.000 &  1.799 -1.12e-1 &  1.769   -1.08e-1  &  1.702   -1.01e-1  &   1.499   -8.02e-2     \\
10.591 &  1.718 -8.50e-2 &  1.690   -8.41e-2 &   1.628   -8.21e-2  &   1.440   -7.59e-2     \\
11.000 &  1.690 -6.65e-2 &  1.662   -6.81e-2 &   1.600   -7.16e-2  &   1.413   -8.21e-2    \\
11.500 &  1.646 -6.29e-2 &  1.619   -6.70e-2 &   1.559   -7.62e-2  &   1.378   -1.04e-1     \\
12.500 &  1.587 -6.41e-2 &  1.563   -7.42e-2 &   1.509   -9.68e-2   &  1.348   -1.65e-1    \\
13.000 &  1.575 -6.85e-2 &  1.553   -8.07e-2 &   1.593   -1.08e-1  &   1.354   -1.91e-1     \\
14.000 &  1.548 -7.66e-2 &  1.531   -9.18e-2 &   1.491   -1.26e-1  &   1.374   -2.28e-1     \\
14.800 &  1.479 -1.00e-1 &  1.468   -1.15e-1 &   1.442   -1.50e-1  &   1.365   -2.53e-1    \\
15.000 &  1.465 -1.70e-1 &  1.455   -1.82e-1 &   1.432   -2.09e-1  &   1.364   -2.90e-1   \\
16.400 &  1.705 -1.42e-1 &  1.686   -1.57e-1 &   1.645   -1.90e-1  &   1.520   -2.89e-1    \\
17.200 &  1.945 -1.98e-1 &  1.916   -2.10e-1 &   1.851   -2.37e-1  &   1.657   -3.17e-1   \\
18.000 &  1.878 -1.61e-1 &  1.854   -1.74e-1 &   1.802   -2.05e-1  &   1.643   -2.98e-1     \\
18.500 & 1.787 -1.55e-1 &  1.769   -1.69e-1  &  1.729   -2.00e-1   &  1.609   -2.92e-1     \\
20.000 &  1.988 -2.20e-1 &  1.962   -2.28e-1 &   1.903   -2.49e-1  &   1.726   -3.00e-1     \\
21.300 &  1.973 -2.45e-1 &  1.948   -2.52e-1 &   1.892   -2.68e-1  &   1.724   -3.14e-1     \\
22.500 &  1.978 -2.52e-1 &  1.946   -2.58e-1 &   1.892   -2.72e-1  &   1.731   -3.13e-1     \\
25.000 &  1.907 -2.68e-1 &  1.888   -2.73e-1 &   1.844   -2.83e-1  &   1.713   -3.13e-1    \\
27.900 &  1.855 -2.99e-1 &  1.839   -2.01e-1 &   1.804   -3.06e-1  &   1.697   -3.19e-1    \\
30.000 &  1.814 -3.36e-1 &  1.800   -3.36e-1 &   1.770   -3.35e-1  &   1.678   -3.32e-1     \\
35.000 &  1.914 -4.30e-1 &  1.894   -4.25e-1 &   1.850   -4.14e-1  &   1.717   -3.81e-1     \\
40.000 &  1.932 -5.30e-1 &  1.911   -5.22e-1 &   1.863   -5.16e-1  &   1.719   -4.55e-1    \\
\hline
\end{tabular}
\caption{Long wavelength values of the complex refractive index of the large rural aerosol mode at low humidity}
\end{table}
\end{center}

\begin{center}
\begin{table}
\begin{tabular}{| c | c | c | c | c |  }
\hline
 $\lambda \mu m$   & 90\%  & 95\%  & 98\%  & 99\% \\
\hline
0.2000  &   1.435   -2.06e-2 &   1.426   -1.57e-2  &  1.408   -6.04e-3 &   1.403   -3.43e-3  \\
0.2500  &   1.411   -8.84e-3 &   1.400   -6.73e-3  &  1.377   -2.59e-3 &   1.370   -1.47e-3  \\
0.3300  &   1.402   -2.36e-3 &   1.390   -1.79e-3  &  1.365   -6.91e-4 &   1.358   -3.92e-4  \\
0.3371  &   1.400   -1.74e-3 &   1.386   -1.32e-3  &  1.361   -5.09e-4 &   1.354   -2.89e-4  \\
0.4000  &   1.395   -1.74e-3 &   1.382   -1.32e-3  &  1.355   -5.09e-4 &   1.348   -2.89e-4  \\
0.4880  &   1.392   -1.74e-3 &   1.379   -1.32e-3  &  1.352   -5.09e-4 &   1.345   -2.89e-4  \\
0.5145  &   1.392   -1.74e-3 &   1.378   -1.32e-3   & 1.351   -5.09e-4 &   1.344   -2.89e-4  \\
0.5500   &  1.391   -1.94e-3 &   1.377   -1.48e-3  &  1.350   -5.70e-4 &   1.343   -3.23e-4  \\
0.6328  &   1.390   -1.94e-3 &   1.376   -1.48e-3  &  1.349   -5.70e-4 &   1.342   -3.23e-4  \\
0.6943  &   1.390   -2.15e-3 &   1.376   -1.64e-3  &  1.348   -6.30e-4 &   1.341   -3.57e-4  \\
0.8600  &   1.385   -3.18e-3 &   1.372   -2.42e-3  &  1.345   -9.33e-4 &   1.338   -5.29e-4  \\
1.0600  &   1.383   -4.22e-3 &   1.369   -3.21e-3  &  1.343   -1.24e-3 &   1.335   -7.04e-4  \\
1.3000   &  1.374   -4.86e-3 &   1.362   -3.71e-3  &  1.338   -1.45e-3 &   1.331   -8.38e-4  \\
1.5360   &  1.365   -5.52e-3 &   1.354   -4.23e-3  &  1.332   -1.69e-3 &   1.326   -1.00e-3  \\
1.8000  &   1.344   -4.29e-3 &   1.336   -3.30e-3  &  1.321   -1.34e-3 &   1.317   -8.09e-4  \\
2.0000  &   1.325   -3.13e-3 &   1.321   -2.65e-3  &  1.312   -1.70e-3 &   1.309   -1.04e-3  \\
2.2500  &   1.312   -3.13e-3 &   1.307   -2.48e-3  &  1.298   -1.19e-3 &   1.295   -8.46e-4  \\
2.5000 &    1.287   -4.50e-3 &   1.281   -3.84e-3 &   1.269   -2.55e-3 &   1.265   -2.20e-3  \\
2.7000 &    1.231   -2.59e-2 &   1.221   -2.52e-2 &   1.201   -2.10e-2 &   1.195   -2.01e-2  \\
3.0000 &    1.362   -1.97e-1 &   1.364   -2.15e-1 &   1.368   -2.50e-1 &   1.370   -2.60e-1  \\
3.2000 &    1.445   -6.77e-2 &   1.353   -7.36e-2 &   1.468   -8.52e-2 &   1.473   -8.83e-2  \\
3.3923 &    1.409   -1.70e-2 &   1.412   -1.78e-2 &   1.418   -1.94e-2 &   1.420   -1.98e-2  \\
3.5000 &    1.400   -8.63e-3 &   1.400   -8.82e-3 &   1.400   -9.18e-3 &   1.400   -9.27e-3  \\
3.7500 &    1.377   -4.27e-3 &   1.375   -4.08e-3 &   1.371   -3.72e-3 &   1.370   -3.63e-3  \\
4.0000 &    1.364   -5.34e-3 &   1.361   -5.16e-3 &   1.355   -4.82e-3 &   1.353   -4.72e-3  \\
4.5000 &    1.352   -1.34e-2  &  1.347   -1.34e-2 &   1.338   -1.34e-2 &   1.335   -1.34e-2  \\
5.0000 &    1.344   -1.26e-2 &   1.340   -1.26e-2 &   1.331   -1.25e-2 &   1.328   -1.24e-2  \\
5.5000 &    1.320   -1.38e-2  &  1.315   -1.32e-2  &  1.305   -1.22e-2 &   1.302   -1.20e-2  \\
6.0000 &    1.285   -8.35e-2 &   1.280   -8.91e-2 &   1.271   -1.00e-1  &  1.268   -1.03e-1  \\
6.2000 &    1.387   -7.11e-2 &   1.359   -7.51e-2 &   1.361   -8.32e-2  &  1.362   -8.52e-2  \\
6.5000 &    1.345   -3.82e-2 &   1.344   -3.84e-2 &   1.341   -3.89e-2  &  1.340   -3.90e-2  \\
7.2000 &    1.338   -4.19e-2 &   1.332   -3.96e-2 &   1.320   -3.50e-2  &  1.316   -3.37e-2  \\
\hline
\end{tabular}
\caption{Short wavelength values of the complex refractive index of the large rural aerosol mode at high humidity}
\end{table}
\end{center}

\begin{center}
\begin{table}
\begin{tabular}{| c | c | c | c | c |  }
\hline
 $\lambda \mu m$   & 90\%  & 95\%  & 98\%  & 99\% \\
\hline
7.9000 &    1.262   -4.09e-2 &   1.270   -3.92e-2  &  1.285   -3.59e-2  &  1.289   -3.51e-2  \\
8.2000 &    1.215   -5.19e-2 &   1.232   -4.79e-2  &  1.265   -4.00e-2  &  1.274   -3.79e-2  \\
8.5000 &    1.284   -7.81e-2  &  1.283   -6.12e-2 &   1.280   -4.88e-2  &  1.279   -4.35e-2  \\
8.7000 &    1.516   -9.53e-2  &  1.458   -8.16e-2 &   1.344   -5.47e-2  &  1.313   -4.74e-2  \\
9.0000 &    1.568   -1.17e-1  &  1.495   -9.84e-2 &   1.352   -6.24e-2 &   1.313   -5.27e-2  \\
9.2000 &    1.491   -1.29e-1  &  1.435   -1.08e-1 &   1.324   -6.72e-2 &   1.294   -5.61e-2  \\
9.5000 &    1.432   -7.86e-2  &  1.387   -7.04e-2 &   1.298   -5.44e-2 &   1.274   -5.00e-2  \\
9.8000 &    1.406   -6.77e-2 &   1.364   -6.30e-2 &   1.281   -5.37e-2  &  1.258   -5.12e-2  \\
10.000 &    1.389   -6.87e-2 &   1.348   -6.44e-2  &  1.268   -5.61e-2 &   1.246   -5.38e-2  \\
10.591 &    1.338   -7.26e-2 &   1.300   -7.14e-2 &   1.226   -6.89e-2  &  1.205   -6.83e-2  \\
11.000 &    1.311   -8.79e-2 &   1.273   -9.00e-2 &   1.199   -9.42e-2  &  1.179   -9.53e-2  \\
11.500 &   1.279   -1.19e-1  &  1.243   -1.24e-1  &  1.171   -1.35e-1  &  1.151   -1.38e-1  \\
12.500 &    1.260   -2.02e-1 &   1.227   -2.15e-1  &  1.163   -2.42e-1  &  1.146   -2.49e-1  \\
13.000  &   1.272   -2.35e-1 &   1.242   -2.52e-1  &  1.183   -2.85e-1  &  1.167   -2.93e-1  \\
14.000  &   1.316   -2.84e-1 &   1.286   -3.04e-1 &   1.239   -3.45e-1  &  1.227   -3.56e-1  \\
14.800  &   1.323   -3.09e-1 &   1.308   -3.30e-1  &  1.277   -3.71e-1  &  1.269   -3.82e-1  \\
15.000  &   1.327   -3.34e-1 &   1.314   -3.50e-1 &   1.287   -3.82e-1  &  1.280   -3.91e-1  \\
16.400  &   1.452   -3.43e-1 &   1.426   -3.63e-1  &  1.377   -4.02e-1  &  1.364   -4.13e-1  \\
17.200  &   1.551   -3.61e-1  &  1.511   -3.77e-1 &   1.434   -4.09e-1 &   1.413   -4.18e-1  \\
18.000  &   1.557   -3.48e-1 &   1.525   -3.66e-1 &   1.462   -4.03e-1 &   1.445   -4.13e-1  \\
18.500  &   1.544   -3.43e-1 &   1.520   -3.61e-1 &   1.473   -3.98e-1 &   1.460   -4.08e-1  \\
20.000  &   1.630   -3.42e-1 &   1.594   -3.54e-1  &  1.524   -3.78e-1 &   1.505   -3.85e-1  \\
21.300  &   1.633   -3.40e-1  &  1.599   -3.49e-1 &   1.533   -3.68e-1 &   1.515   -3.73e-1  \\
22.500  &   1.643   -3.35e-1  &  1.610   -3.44e-1 &   1.546   -3.60e-1  &  1.529   -3.64e-1  \\
25.000  &   1.642   -3.30e-1  &  1.615   -3.46e-1 &   1.563   -3.48e-1  &  1.549   -3.52e-1  \\
27.900  &   1.639   -3.27e-1  &  1.618   -3.30e-1 &   1.575   -3.35e-1  &  1.564   -3.37e-1  \\
30.000  &   1.628   -3.30e-1 &   1.610   -3.30e-1 &   1.574   -3.29e-1  &  1.564   -3.28e-1  \\
35.000  &   1.654   -3.64e-1 &   1.618   -3.57e-1  &  1.565   -3.44e-1  &  1.561   -3.41e-1  \\
40.000  &   1.642   -4.28e-1 &   1.612   -4.18e-1  &  1.555   -3.98e-1  &  1.539   -3.92e-1 \\
\hline
\end{tabular}
\caption{Long wavelength values of the complex refractive index of the large rural aerosol mode at high humidity}
\end{table}
\end{center}



\newpage

\bibliography{/home/daddio/Articles/Mybib}
%\newpage
%\vspace*{20cm}
%\begin{figure}[htb]
%\special{psfile=Dodec.eps vscale=50 hscale=50 voffset=10 hoffset=10}
%\caption{ 
%A computer perspective drawing of the dodecahedron.
%}
%\end{figure}

\end{document}

